<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                {left: "$$", right: "$$", display: true},
                {left: "$", right: "$", display: false}
            ]
        });
    });
</script>
<meta name="robots" content="index, follow">
<title>Focal Loss for Dense Object Detection | Landodo&#39;s NoteBook</title>
<meta name="keywords" content="è®ºæ–‡é˜…è¯», ç›®æ ‡æ£€æµ‹" />
<meta name="description" content="ç›®æ ‡æ£€æµ‹ä»»åŠ¡ï¼ˆ1ï¼‰ â›³æœ¬æŠ¥å‘Šä¸»è¦æ˜¯é’ˆå¯¹ç›®æ ‡æ£€æµ‹ä»»åŠ¡ä¸­æ­£è´Ÿæ ·æœ¬ä¸å¹³è¡¡ã€éš¾æ˜“æ ·æœ¬ä¸å¹³è¡¡è¿™ä¸¤ä¸ªé—®é¢˜è¿›è¡Œç®€è¦è®¨è®ºã€‚ è®ºæ–‡ç®€ä»‹ Lin, T., Goyal, P., Girshick, R.B., He, K., &amp; DollÃ¡">
<meta name="author" content="">
<link rel="canonical" href="http://landodo.github.io/posts/20210827-focal-loss/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css" integrity="sha256-yIlj/i15RiAA/Q&#43;xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js" integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="http://landodo.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://landodo.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://landodo.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://landodo.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="http://landodo.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Focal Loss for Dense Object Detection" />
<meta property="og:description" content="ç›®æ ‡æ£€æµ‹ä»»åŠ¡ï¼ˆ1ï¼‰ â›³æœ¬æŠ¥å‘Šä¸»è¦æ˜¯é’ˆå¯¹ç›®æ ‡æ£€æµ‹ä»»åŠ¡ä¸­æ­£è´Ÿæ ·æœ¬ä¸å¹³è¡¡ã€éš¾æ˜“æ ·æœ¬ä¸å¹³è¡¡è¿™ä¸¤ä¸ªé—®é¢˜è¿›è¡Œç®€è¦è®¨è®ºã€‚ è®ºæ–‡ç®€ä»‹ Lin, T., Goyal, P., Girshick, R.B., He, K., &amp; DollÃ¡" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://landodo.github.io/posts/20210827-focal-loss/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-27T09:19:10&#43;08:00" />
<meta property="article:modified_time" content="2021-08-27T09:19:10&#43;08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Focal Loss for Dense Object Detection"/>
<meta name="twitter:description" content="ç›®æ ‡æ£€æµ‹ä»»åŠ¡ï¼ˆ1ï¼‰ â›³æœ¬æŠ¥å‘Šä¸»è¦æ˜¯é’ˆå¯¹ç›®æ ‡æ£€æµ‹ä»»åŠ¡ä¸­æ­£è´Ÿæ ·æœ¬ä¸å¹³è¡¡ã€éš¾æ˜“æ ·æœ¬ä¸å¹³è¡¡è¿™ä¸¤ä¸ªé—®é¢˜è¿›è¡Œç®€è¦è®¨è®ºã€‚ è®ºæ–‡ç®€ä»‹ Lin, T., Goyal, P., Girshick, R.B., He, K., &amp; DollÃ¡"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://landodo.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Focal Loss for Dense Object Detection",
      "item": "http://landodo.github.io/posts/20210827-focal-loss/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Focal Loss for Dense Object Detection",
  "name": "Focal Loss for Dense Object Detection",
  "description": "ç›®æ ‡æ£€æµ‹ä»»åŠ¡ï¼ˆ1ï¼‰ â›³æœ¬æŠ¥å‘Šä¸»è¦æ˜¯é’ˆå¯¹ç›®æ ‡æ£€æµ‹ä»»åŠ¡ä¸­æ­£è´Ÿæ ·æœ¬ä¸å¹³è¡¡ã€éš¾æ˜“æ ·æœ¬ä¸å¹³è¡¡è¿™ä¸¤ä¸ªé—®é¢˜è¿›è¡Œç®€è¦è®¨è®ºã€‚ è®ºæ–‡ç®€ä»‹ Lin, T., Goyal, P., Girshick, R.B., He, K., \u0026amp; DollÃ¡",
  "keywords": [
    "è®ºæ–‡é˜…è¯»", "ç›®æ ‡æ£€æµ‹"
  ],
  "articleBody": "ç›®æ ‡æ£€æµ‹ä»»åŠ¡ï¼ˆ1ï¼‰ â›³æœ¬æŠ¥å‘Šä¸»è¦æ˜¯é’ˆå¯¹ç›®æ ‡æ£€æµ‹ä»»åŠ¡ä¸­æ­£è´Ÿæ ·æœ¬ä¸å¹³è¡¡ã€éš¾æ˜“æ ·æœ¬ä¸å¹³è¡¡è¿™ä¸¤ä¸ªé—®é¢˜è¿›è¡Œç®€è¦è®¨è®ºã€‚\nè®ºæ–‡ç®€ä»‹  Lin, T., Goyal, P., Girshick, R.B., He, K., \u0026 DollÃ¡r, P. (2017). Focal Loss for Dense Object Detection. 2017 IEEE International Conference on Computer Vision (ICCV), 2999-3007.\n   Focal Loss\n  ICCV 2017, Best student paper.\n  https://arxiv.org/abs/1708.02002\n  1. èƒŒæ™¯ ä»¥ 2014 å¹´ä¸ºåˆ†ç•Œï¼Œç›®æ ‡æ£€æµ‹çš„å‘å±•å†ç¨‹å¯ä»¥åˆ†ä¸ºä¸¤å¤§éƒ¨åˆ†ï¼šä¼ ç»Ÿç›®æ ‡æ£€æµ‹æ—¶æœŸã€åŸºäºæ·±åº¦å­¦ä¹ çš„ç›®æ ‡æ£€æµ‹æ—¶æœŸã€‚\n Zou, Z., Shi, Z., Guo, Y., \u0026 Ye, J. (2019). Object Detection in 20 Years: A Survey. ArXiv, abs/1905.05055.\n åœ¨åŸºäºæ·±åº¦å­¦ä¹ çš„ç›®æ ‡æ£€æµ‹ç®—æ³•ä¸­ï¼Œåˆå¯ä»¥åˆ†ä¸ºå•é˜¶æ®µï¼ˆOne/Single-stageï¼‰å’Œä¸¤é˜¶æ®µï¼ˆTwo-stageï¼‰ä¸¤ç§å¤§ç±»ã€‚å½“ç„¶è¿˜æœ‰å¤šé˜¶æ®µï¼ˆMulti-stageï¼‰ï¼Œä½†æ˜¯å…¶é€Ÿåº¦å’Œç²¾åº¦éƒ½æ¯”è¾ƒä½ï¼Œå·²ç»è¢«æ·˜æ±°äº†ã€‚\n1.1 One-Stage and Two-stage One-stage å’Œ Two-stage çš„ä¸»è¦åŒºåˆ«åœ¨äºå—å¦å­˜åœ¨ Region Proposalï¼ˆå¯èƒ½åŒ…å«å¾…æ£€ç‰©ä½“çš„é¢„é€‰æ¡†ï¼‰æ“ä½œã€‚ä»¥ Two-stage æ–¹æ³•ä¸­çš„ä»£è¡¨ Faster RCNN ä¸ºä¾‹ï¼Œç®—æ³•ä¼šå…ˆç”Ÿæˆå€™é€‰æ¡†ï¼ˆRegion proposalsï¼Œå¯èƒ½åŒ…å«ç‰©ä½“çš„åŒºåŸŸï¼‰ï¼Œç„¶åå†å¯¹æ¯ä¸ªå€™é€‰æ¡†è¿›è¡Œåˆ†ç±»å’Œä¿®æ­£ä½ç½®ï¼›è€Œ One-stage ç®—æ³•ä¼šç›´æ¥åœ¨ç½‘ç»œä¸­æå–ç‰¹å¾æ¥é¢„æµ‹ç‰©ä½“åˆ†ç±»å’Œä½ç½®ã€‚\nä¸¤ç§æ–¹æ³•éƒ½å­˜åœ¨å„è‡ªçš„ä¼˜ç¼ºç‚¹ã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒOne-stage æ–¹æ³•åœ¨é€Ÿåº¦ä¸Šå­˜åœ¨ä¼˜åŠ¿ï¼Œä½†æ˜¯åœ¨ç²¾åº¦ä¸Šä¼šå·®äº Two-stageï¼Œä¸»è¦åŸå› å¯ä»¥æ€»ç»“ä¸ºï¼šæ­£è´Ÿæ ·æœ¬ä¸å¹³è¡¡ï¼ˆå’Œéš¾æ˜“æ ·æœ¬ä¸å¹³è¡¡ï¼‰é€ æˆäº† One-stage æ–¹æ³•åœ¨ç²¾åº¦ä¸Šçš„åŠ£åŠ¿ã€‚å…·ä½“åˆ†æå¦‚ä¸‹ï¼š\n  One-stage ç½‘ç»œæœ€ç»ˆå­¦ä¹ çš„ Anchor æœ‰å¾ˆå¤šï¼Œä½†æ˜¯åªæœ‰å°‘æ•° Anchor å¯¹æœ€ç»ˆç½‘ç»œçš„å­¦ä¹ æ˜¯æœ‰åˆ©çš„ï¼Œè€Œå¤§éƒ¨åˆ† Anchor å¯¹æœ€ç»ˆç½‘ç»œçš„å­¦ä¹ éƒ½æ˜¯ä¸åˆ©çš„ï¼Œè¿™éƒ¨åˆ†çš„ Anchor å¾ˆå¤§ç¨‹åº¦ä¸Šå½±å“äº†æ•´ä¸ªç½‘ç»œçš„å­¦ä¹ ï¼Œæ‹‰ä½äº†æ•´ä½“çš„å‡†ç¡®ç‡ï¼›\n  Two-stage ç½‘ç»œæœ€ç»ˆå­¦ä¹ çš„ Anchor è™½ç„¶ä¸å¤šï¼Œä½†æ˜¯èƒŒæ™¯ Anchor ä¹Ÿå°±æ˜¯å¯¹ç½‘ç»œå­¦ä¹ ä¸åˆ©çš„ Anchor ä¹Ÿä¸ä¼šç‰¹åˆ«å¤šï¼Œå®ƒè™½ç„¶ä¹Ÿèƒ½å½±å“æ•´ä½“çš„å‡†ç¡®ç‡ï¼Œä½†æ˜¯è‚¯å®šæ²¡æœ‰ One-stage å½±å“å¾—é‚£ä¹ˆä¸¥é‡ï¼Œæ‰€ä»¥å®ƒçš„å‡†ç¡®ç‡æ¯” One-stage è‚¯å®šè¦é«˜ã€‚\n  å¯¹äºæ­£è´Ÿæ ·æœ¬ä¸å¹³è¡¡é—®é¢˜ï¼Œæ˜¯æ¯”è¾ƒå¥½è§£å†³çš„ï¼Œä¹Ÿå­˜åœ¨ä¸å°‘çš„ç°æœ‰æ–¹æ³•ã€‚Focal Loss çš„æå‡ºï¼Œä¸»è¦é’ˆå¯¹éš¾æ˜“æ ·æœ¬çš„ä¸å¹³è¡¡é—®é¢˜ã€‚æœ‰äº† Focal Lossï¼Œè®­ç»ƒè¿‡ç¨‹å…³æ³¨å¯¹è±¡çš„æ¬¡åºä¸ºï¼šï¼ˆæ­£/éš¾ï¼‰  ï¼ˆè´Ÿ/éš¾ï¼‰  ï¼ˆæ­£/æ˜“ï¼‰  ï¼ˆè´Ÿ/æ˜“ï¼‰ã€‚è¯¥æŸå¤±å‡½æ•°é€šè¿‡æŠ‘åˆ¶é‚£äº›å®¹æ˜“åˆ†ç±»æ ·æœ¬çš„æƒé‡ï¼Œå°†æ³¨æ„åŠ›é›†ä¸­åœ¨é‚£äº›éš¾ä»¥åŒºåˆ†çš„æ ·æœ¬ä¸Šï¼Œæœ‰æ•ˆæ§åˆ¶æ­£è´Ÿæ ·æœ¬æ¯”ä¾‹ï¼Œé˜²æ­¢å¤±è¡¡ç°è±¡ã€‚\n============================================================\nåœ¨å¼€å§‹ä»‹ç» Focal Loss ä¹‹å‰ï¼Œæˆ‘è¡¥å……ä¸€äº›ç›®æ ‡æ£€æµ‹çš„åŸºç¡€çŸ¥è¯†ï¼Œæˆ‘ä¹Ÿæ˜¯æ‰åˆšå¼€å§‹å­¦ä¹ ç›®æ ‡æ£€æµ‹ã€‚\nï¼ˆ1ï¼‰ç›®æ ‡æ£€æµ‹ä¸­çš„å„ç§â€œæ¡†â€\n ground truthï¼šæ ‡æ³¨æ¡† Anchorï¼šäººä¸ºè®¾ç½®çš„åˆå§‹å…ˆéªŒæ¡† proposalï¼šRPN çš„è¾“å‡ºï¼ˆå¯èƒ½åŒ…å«ç‰©ä½“çš„å€™é€‰æ¡†ï¼‰ï¼Œå³å¯¹ Anchor ç¬¬ä¸€æ¬¡åšå›å½’å¾—åˆ°çš„ç»“æœ RoIï¼šRPN é˜¶æ®µè¾“å‡ºçš„ Proposal ç»è¿‡æ’åºå– topKï¼Œç„¶ååš NMS å–ä¸€å®šæ•°é‡çš„æ¡†ï¼Œç”¨äºç¬¬äºŒé˜¶æ®µçš„å†æ¬¡ç²¾ä¿® bounding boxï¼šproposal ç»è¿‡å†æ¬¡ç²¾ä¿®åçš„é¢„æµ‹æ¡†ï¼Œç”±äºè®¡ç®— APï¼ŒAP æŒ‡çš„æ˜¯ bounding box APã€‚  ï¼ˆ2ï¼‰ç›®æ ‡æ£€æµ‹ä»»åŠ¡çš„è¯„ä¼°æŒ‡æ ‡ mAP\nhttps://www.zhihu.com/question/53405779/answer/993913699\nAPï¼šPR æ›²çº¿ä¸‹é¢ç§¯ï¼Œå…ˆè€ƒè™‘è®¡ç®— APï¼Œå³ä¸€ä¸ªç±»åˆ«ã€‚\n 7 å¼ å›¾åƒï¼ˆå‡è®¾æ˜¯ä¸€ä¸ª Batchï¼‰ï¼Œ15 ä¸ª ground truthï¼Œ24 ä¸ªé¢„æµ‹æ¡† ï¼ˆ1ï¼‰è®¡ç®—é¢„æµ‹æ¡†æ˜¯ TP or FPï¼ˆè®¡ç®— bbox ä¸ Ground truth çš„ IoUï¼Œæ ¹æ®é˜ˆå€¼åˆ¤æ–­ï¼‰ï¼Œå¦‚æœä¸€ä¸ª Ground Truth æœ‰å¤šä¸ªé¢„æµ‹æ¡†ï¼Œåˆ™ IoU æœ€å¤§ä¸º TPï¼Œå…¶ä»–ä¸º FPï¼› ï¼ˆ2ï¼‰æ ¹æ®ç½®ä¿¡åº¦ä»å¤§åˆ°å°æ’åºæ‰€æœ‰çš„é¢„æµ‹æ¡†ï¼› ï¼ˆ3ï¼‰è®¡ç®— Precision = TP / (ACC_TP + ACC_FP)ã€Recall = TP / (all grouth truth)ï¼›  ACC è¡¨ç¤ºç´¯åŠ ï¼Œall ground truth æ˜¯ä¸€ä¸ªå›ºå®šå€¼   ï¼ˆ4ï¼‰ç»˜åˆ¶ PR æ›²çº¿ï¼› ï¼ˆ5ï¼‰è®¡ç®—æ›²çº¿ä¸‹çš„é¢ç§¯ï¼Œ11 ä¸ªç‚¹ [0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1] çš„æ’å€¼è¿›è¡Œè®¡ç®—ï¼ˆ10 ä¸ªçŸ©å½¢çš„é¢ç§¯ä¹‹å’Œï¼‰ ï¼ˆ6ï¼‰æ‰€æœ‰ç±»åˆ«çš„ AP è®¡ç®—éƒ½åˆ†åˆ«å‡ºæ¥ï¼Œç„¶åæ±‚å–å¹³å‡å¾—åˆ° mAPã€‚  2. Focal Loss å…ˆä»äºŒåˆ†ç±»çš„äº¤å‰ç†µå¼€å§‹ï¼š\n $y \\in {\\pm 1}$ ä»£è¡¨ ground truthï¼ˆçœŸå®å€¼ï¼‰ $p \\in [0, 1]$ è¡¨ç¤ºæ¨¡å‹è¾“å‡ºæ ‡ç­¾ä¸º 1 çš„æ¦‚ç‡ï¼ˆé¢„æµ‹å€¼ï¼‰  å®šä¹‰ä¸€ä¸ª $p_t$ï¼š\nåˆ™äº¤å‰ç†µå¯ä»¥å†™ä¸º $CE(p, y) = CE(p_t) = -log(p_t)$\näº¤å‰ç†µæŸå¤±å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚ Figure 1.ï¼Œå³ä½¿é‚£äº›å¾ˆå®¹æ˜“ easily classified çš„æ ·æœ¬ï¼ˆ$p_t Â» 0.5$ï¼‰ï¼Œä»ä¼šé€ æˆå¾ˆæ˜¾è‘—çš„æŸå¤±å€¼ã€‚å½“è¿™äº› easy example æ•°é‡åºå¤§æ—¶ï¼Œå…¶ç´¯è®¡èµ·æ¥çš„æŸå¤±å¯èƒ½ä¼šè¿œè¿œå¤§äºï¼ˆoverwhelmï¼‰é‚£äº› rare classã€‚\n æˆ‘è®¤ä¸ºè¿™å¾ˆç±»ä¼¼äºæ”¿æ²»ä¸Šçš„æ°‘ä¸»æš´æ”¿ã€‚\n 2.1 Balanced Cross Entropy è§£å†³æ­£è´Ÿæ ·æœ¬ä¸å¹³è¡¡çš„å¸¸ç”¨æ–¹æ³•æ˜¯å¯¹ç±»åˆ« 1 å¼•å…¥æƒé‡å› å­ Î±âˆˆ[0,1]ï¼Œå¯¹ç±»åˆ« -1 å¼•å…¥æƒé‡å› å­ 1-Î±ã€‚å¾—åˆ° Î±-balanced CE lossï¼š\nå³ï¼Œ\n2.2 Focal Loss Easily classified negatives comprise the majority of the loss and dominate the gradient. Î± balances the importance of positive/negative examples, it does not differentiate between easy/hard examples.\nå› æ­¤ï¼ŒFocal Loss çš„ä¸»è¦ç›®æ ‡æ˜¯ down-weight easy exampleï¼Œä½¿å¾—èƒ½å¤Ÿ focus training on hard exampleã€‚Focal Loss å®šä¹‰å¦‚ä¸‹ï¼š\n $(1 - p_t)^{\\gamma}$ æ˜¯ modulating factorï¼ˆè°ƒèŠ‚å› å­ï¼‰ $\\gamma$ æ˜¯ä¸€ä¸ªå¯è°ƒèŠ‚çš„è¶…å‚æ•°ï¼Œfocusing parameterï¼ˆèšç„¦å‚æ•°ï¼‰  Focal Loss æœ‰ä¸¤ä¸ªæ€§è´¨ï¼š\nï¼ˆ1ï¼‰å½“ä¸€ä¸ªæ ·æœ¬å‡ºç°äº†é”™è¯¯åˆ†ç±»ï¼Œä¸” $p_t$ éå¸¸å°ï¼Œåˆ™ $(1 - p_t)^{\\gamma}$ éå¸¸æ¥è¿‘ 1ï¼ŒLoss ä¸å—å½±å“ï¼›å½“ $p_t$ æ¥è¿‘äº 1 æ—¶ï¼Œ$(1 - p_t)^{\\gamma}$ æ¥è¿‘ 0ï¼Œå¯¹äº well-classified examples çš„ Loss å°†ä¼šé™ä½æƒé‡ï¼ˆdown-weightedï¼‰ã€‚å› æ­¤æ¨¡å‹çš„ Loss å°±é›†ä¸­åœ¨é‚£äº›é”™è¯¯åˆ†ç±»æ ·æœ¬ä¸Šäº†ï¼ˆhard exampleï¼‰ã€‚\nï¼ˆ2ï¼‰Focusing parameter $\\gamma$ ç”¨äºè°ƒæ•´ç®€å•çš„æ ·æœ¬ï¼ˆeasy examples, well-classified examplesï¼‰çš„ Loss é™ä½æƒé‡ï¼ˆdown-weightedï¼‰çš„é€Ÿç‡ã€‚$\\gamma=0$ æ—¶ï¼ŒFL == CEï¼›$\\gamma = 2$ æ˜¯å®éªŒå¾—åˆ°çš„æœ€å¥½å€¼ã€‚\nIntuitively, the modulating factor reduces the loss contribution from easy examples and extends the range in which an example receives low loss.\nä¾‹å¦‚ï¼š\n $\\gamma = 2$ï¼Œä¸€ä¸ªæ ·æœ¬çš„åˆ†ç±»ç»“æœä¸º $p_t = 0.9$ï¼ˆè¿™å°±æ˜¯ä¸€ä¸ª easy exampleï¼‰ï¼Œåˆ™ $(1 - 0.9)^{2} = 0.01$ã€‚Focal Loss æ¯” CE å° 100 å€ï¼› $p_t = 0.968$ æ—¶ï¼ŒFL æ¯” CE å°è¿‘ 1000 å€ã€‚ åŒç†ï¼Œ$p_t = 0.4$ æ—¶ï¼ˆhard exampleï¼‰ï¼Œåˆ™ $(1 - 0.4)^{2} = 0.36$ã€‚ç›¸å½“äºå˜ç›¸ç»™é”™è¯¯åˆ†ç±»çš„éš¾æ ·æœ¬çš„ Loss å¢åŠ äº†æƒé‡ã€‚â€œincreases the importance of correcting misclassifified examplesâ€  ä¸ºäº†å¹³è¡¡æ­£è´Ÿæ ·æœ¬ï¼Œä½¿ç”¨ Î± æƒé‡ï¼Œå¾—åˆ°æœ€ç»ˆçš„ Focal Loss è¡¨è¾¾å¼ï¼š\nFL æ›´åƒæ˜¯ä¸€ç§æ€æƒ³ï¼Œå…¶ç²¾ç¡®çš„å®šä¹‰å½¢å¼å¹¶ä¸é‡è¦ã€‚\nåœ¨ Two-stage æ–¹æ³•ä¸­ï¼Œå¯¹äºæ­£è´Ÿæ ·æœ¬ä¸å¹³è¡¡é—®é¢˜ï¼Œä¸»è¦æ˜¯é€šè¿‡å¦‚ä¸‹æ–¹æ³•ç¼“è§£ï¼š\n ï¼ˆ1ï¼‰object proposal mechanismï¼šreduces the nearly infifinite set of possible object locations down to one or two thousand. ï¼ˆ2ï¼‰ biased samplingï¼š1:3 ratio of positive to negative examples.  åŒæ—¶ï¼Œåœ¨æ¨¡å‹åˆå§‹åŒ–æ—¶ï¼Œå¯ä»¥åŠ å…¥ä¸€ä¸‹å…ˆéªŒçŸ¥è¯†ï¼Œå¯ä»¥ç¼“è§£è®­ç»ƒåˆæœŸçš„ä¸ç¨³å®šç°è±¡ã€‚FL é€šè¿‡ç›´æ¥é€šè¿‡æŸå¤±å‡½æ•°è§£å†³ï¼\nFocal Loss çš„ä»£ç å¯ä»¥å‚è€ƒ MMdetectionï¼šhttps://github.com/open-mmlab/mmdetection/blob/master/mmdet/models/losses/focal_loss.py\n3. RetinaNet ä¸ºäº†éªŒè¯ Focal loss çš„æœ‰æ•ˆæ€§ï¼Œè®¾è®¡äº†ä¸€ä¸ªå« RetinaNet çš„ç½‘ç»œè¿›è¡Œè¯„ä¼°ã€‚å®éªŒç»“æœè¡¨æ˜ï¼ŒRetinaNet èƒ½å¤Ÿåœ¨å®ç°ä¿æŒ one-stage é€Ÿåº¦ä¼˜åŠ¿çš„åŸºç¡€ä¸Šï¼Œåœ¨ç²¾åº¦ä¸Šè¶…è¶Šæ‰€æœ‰ï¼ˆ2017 å¹´ï¼‰two-stage çš„æ£€æµ‹å™¨ï¼ˆ achieves state-of-the-art accuracy and run time on the challenging COCO datasetï¼‰ã€‚\nRetinaNet çš„å·ç§¯è¿‡ç¨‹ç”¨çš„æ˜¯ ResNetï¼Œä¸Šé‡‡æ ·å’Œä¾§è¾¹è¿æ¥è¿˜æ˜¯ FPN ç»“æ„ã€‚é€šè¿‡ä¸»å¹²ç½‘ç»œï¼Œäº§ç”Ÿäº†å¤šå°ºåº¦çš„ç‰¹å¾é‡‘å­—å¡”ã€‚ç„¶ååé¢è¿æ¥ä¸¤ä¸ªå­ç½‘ï¼Œåˆ†åˆ«è¿›è¡Œåˆ†ç±»å’Œå›å½’ã€‚\n4 å®éªŒç»“æœ ä½œè€…åšäº†å¾ˆå¤šæ¶ˆèå­¦ä¹ ï¼Œå¯ä»¥æ€»ç»“å¦‚ä¸‹ï¼š\n ä½œè€…æœ‰å¾ˆå¤šå¡ï¼› $\\alpha$ å’Œ $\\gamma$ è¿™ä¸¤ä¸ªè¶…å‚æ•°æ˜¯äº’ç›¸å½±å“çš„ï¼› Focal loss çš„å¨åŠ›è¿˜æ˜¯å¾ˆå¤§çš„ï¼› $\\gamma=2, \\alpha=0.25$ æ—¶ï¼ŒResNet-101+FPN ä½œä¸º backbone çš„ç»“æ„æœ‰æœ€ä¼˜çš„æ€§èƒ½ï¼›  ä¸‹å›¾æ˜¯æ”¶æ•›æ¨¡å‹ä¸­ä¸åŒ Î³ å€¼çš„æ­£è´Ÿæ ·æœ¬å½’ä¸€åŒ–æŸå¤±çš„ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ã€‚\næ”¹å˜ Î³ å¯¹æ­£æ ·æœ¬çš„æŸå¤±åˆ†å¸ƒçš„å½±å“å¾ˆå°ã€‚ç„¶è€Œï¼Œå¯¹äºè´Ÿæ ·æœ¬ï¼Œå¢åŠ  Î³ ä¼šä½¿å¾—æ¨¡å‹å‡ ä¹æ‰€æœ‰çš„æ³¨æ„åŠ›ä»è´Ÿæ ·æœ¬ä¸Šç¦»å¼€ï¼Œå®ç°äº† down-weight easy exampleã€‚\nFocal Loss ä½¿å¾— One-stage æ–¹æ³•åœ¨ç²¾åº¦ä¸Šè¶…è¶Šäº† Two-stage æ–¹æ³•ã€‚\nFocal Loss çš„ç¼ºç‚¹ï¼šåœ¨é€Ÿåº¦ä¸Šè¿˜å­˜åœ¨å¾ˆå¤§çš„æ”¹è¿›ç©ºé—´ã€‚\næ€»ç»“   One-stage æ–¹æ³•ç›¸æ¯”äº Two-stage æ–¹æ³•ï¼Œåœ¨ç²¾åº¦ç¨æœ‰åŠ£åŠ¿ã€‚ç ”ç©¶å‘ç°ï¼Œæ˜¯æ­£è´Ÿæ ·æœ¬ä¸å¹³è¡¡å’Œéš¾æ˜“æ ·æœ¬ä¸å¹³è¡¡è¿™ä¸¤ä¸ªé—®é¢˜æ‰€å¯¼è‡´çš„ï¼›\n  Focal Loss å‡½æ•°é€šè¿‡æŠ‘åˆ¶é‚£äº›å®¹æ˜“åˆ†ç±»æ ·æœ¬çš„æƒé‡ï¼Œå°†æ³¨æ„åŠ›é›†ä¸­åœ¨é‚£äº›éš¾ä»¥åŒºåˆ†çš„æ ·æœ¬ä¸Šï¼Œæœ‰æ•ˆæ§åˆ¶æ­£è´Ÿæ ·æœ¬æ¯”ä¾‹ï¼Œé˜²æ­¢å¤±è¡¡ç°è±¡ã€‚\n  Focal Loss çš„ä¸»è¦ç›®æ ‡æ˜¯ down-weight easy exampleï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿ focus training on hard exampleã€‚\n  å…·ä½“åšæ³•æ˜¯ï¼Œå¯¹äºéš¾æ˜“æ ·æœ¬ä¸å¹³è¡¡é—®é¢˜ï¼Œå¼•å…¥ modulating factor $(1 - p_t)^{\\gamma}$ï¼Œ Intuitively, the modulating factor reduces the loss contribution from easy examples and extends the range in which an example receives low loss.\n  ä¸ºäº†éªŒè¯ Focal Loss çš„æœ‰æ•ˆæ€§ï¼Œè®¾è®¡äº† RetinaNet ç”¨äºå®éªŒè¯„ä¼°ã€‚\n  RetinaNet èƒ½å¤Ÿåœ¨å®ç°ä¿æŒ one-stage é€Ÿåº¦ä¼˜åŠ¿çš„åŸºç¡€ä¸Šï¼Œåœ¨ç²¾åº¦ä¸Šè¶…è¶Šæ‰€æœ‰ï¼ˆ2017 å¹´ï¼‰two-stage çš„æ£€æµ‹å™¨ï¼ˆ achieves state-of-the-art accuracy and run time on the challenging COCO datasetï¼‰ã€‚\n  RetinaNet ä¹Ÿå­˜åœ¨ç¼ºç‚¹ï¼Œå…¶åœ¨é€Ÿåº¦ä¸Šä»æœ‰å¾ˆå¤§çš„æ”¹è¿›ç©ºé—´ã€‚\n  æ‰©å±•å­¦ä¹  Focal Loss å­˜åœ¨ç¼ºç‚¹ï¼š\n è®©æ¨¡å‹è¿‡å¤šå…³æ³¨é‚£äº›ç‰¹åˆ«éš¾åˆ†çš„æ ·æœ¬è‚¯å®šæ˜¯å­˜åœ¨é—®é¢˜çš„ï¼Œæ ·æœ¬ä¸­æœ‰ç¦»ç¾¤ç‚¹ï¼ˆoutliersï¼‰ï¼Œå¯èƒ½æ¨¡å‹å·²ç»æ”¶æ•›äº†ä½†æ˜¯è¿™äº›ç¦»ç¾¤ç‚¹è¿˜æ˜¯ä¼šè¢«åˆ¤æ–­é”™è¯¯ï¼Œè®©æ¨¡å‹å»å…³æ³¨è¿™æ ·çš„æ ·æœ¬ï¼Œå¯èƒ½å¯¹æœ€åçš„ç»“æœé€ æˆä¸åˆ©çš„å½±å“ï¼› $\\alpha$ å’Œ $\\gamma$ äº’ç›¸å½±å“ï¼Œå…¨å‡­ç»éªŒå¾—åˆ°ï¼ˆä¸åŒçš„æ•°æ®é›†éƒ½è¦å¯»æ‰¾çš„æœ€ä½³çš„ $\\alpha, \\gamma$ï¼Œä»£ä»·æ˜‚è´µï¼‰ï¼› é€Ÿåº¦ä¸Šä»å­˜åœ¨æ”¹è¿›ç©ºé—´ã€‚  ï¼ˆ1ï¼‰GHM(gradient harmonizing mechanism) è§£å†³äº†ä¸Šè¿°å‰ä¸¤ä¸ªé—®é¢˜ã€‚Focal Loss æ˜¯ä»ç½®ä¿¡åº¦ p çš„è§’åº¦å…¥æ‰‹è¡°å‡ Lossï¼Œè€Œ GHM æ˜¯ä¸€å®šèŒƒå›´ç½®ä¿¡åº¦pçš„æ ·æœ¬æ•°é‡çš„è§’åº¦è¡°å‡ Lossã€‚\nï¼ˆ2ï¼‰Generalized Focal Lossï¼Œä¸ä¼šå¸¦æ¥é¢å¤–çš„ Costï¼Œæå‡ 1% çš„ APã€‚\n",
  "wordCount" : "3443",
  "inLanguage": "en",
  "datePublished": "2021-08-27T09:19:10+08:00",
  "dateModified": "2021-08-27T09:19:10+08:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://landodo.github.io/posts/20210827-focal-loss/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Landodo's NoteBook",
    "logo": {
      "@type": "ImageObject",
      "url": "http://landodo.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://landodo.github.io/" accesskey="h" title="Landodo&#39;s NoteBook (Alt + H)">Landodo&#39;s NoteBook</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="http://landodo.github.io/search" title="ğŸ”Search (Alt &#43; /)" accesskey=/>
                    <span>ğŸ”Search</span>
                </a>
            </li>
            <li>
                <a href="http://landodo.github.io/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="http://landodo.github.io/archives/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="http://landodo.github.io/tags" title="Tag">
                    <span>Tag</span>
                </a>
            </li>
            <li>
                <a href="http://landodo.github.io/about" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="http://landodo.github.io/cs-zoo" title="CS ZOO">
                    <span>CS ZOO</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://landodo.github.io/">Home</a>&nbsp;Â»&nbsp;<a href="http://landodo.github.io/posts/">Posts</a></div>
    <h1 class="post-title">
      Focal Loss for Dense Object Detection
    </h1>
    <div class="post-meta"><span title='2021-08-27 09:19:10 +0800 CST'>August 27, 2021</span>&nbsp;Â·&nbsp;7 min&nbsp;Â·&nbsp;3443 words

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e7%9b%ae%e6%a0%87%e6%a3%80%e6%b5%8b%e4%bb%bb%e5%8a%a11" aria-label="ç›®æ ‡æ£€æµ‹ä»»åŠ¡ï¼ˆ1ï¼‰">ç›®æ ‡æ£€æµ‹ä»»åŠ¡ï¼ˆ1ï¼‰</a><ul>
                        
                <li>
                    <a href="#%e8%ae%ba%e6%96%87%e7%ae%80%e4%bb%8b" aria-label="è®ºæ–‡ç®€ä»‹">è®ºæ–‡ç®€ä»‹</a></li>
                <li>
                    <a href="#1-%e8%83%8c%e6%99%af" aria-label="1. èƒŒæ™¯">1. èƒŒæ™¯</a><ul>
                        
                <li>
                    <a href="#11-one-stage-and-two-stage" aria-label="1.1 One-Stage and Two-stage">1.1 One-Stage and Two-stage</a></li></ul>
                </li>
                <li>
                    <a href="#2-focal-loss" aria-label="2. Focal Loss">2. Focal Loss</a><ul>
                        
                <li>
                    <a href="#21-balanced-cross-entropy" aria-label="2.1 Balanced Cross Entropy">2.1 Balanced Cross Entropy</a></li>
                <li>
                    <a href="#22-focal-loss" aria-label="2.2 Focal Loss">2.2 Focal Loss</a></li></ul>
                </li>
                <li>
                    <a href="#3-retinanet" aria-label="3. RetinaNet">3. RetinaNet</a></li>
                <li>
                    <a href="#4-%e5%ae%9e%e9%aa%8c%e7%bb%93%e6%9e%9c" aria-label="4 å®éªŒç»“æœ">4 å®éªŒç»“æœ</a></li>
                <li>
                    <a href="#%e6%80%bb%e7%bb%93" aria-label="æ€»ç»“">æ€»ç»“</a></li>
                <li>
                    <a href="#%e6%89%a9%e5%b1%95%e5%ad%a6%e4%b9%a0" aria-label="æ‰©å±•å­¦ä¹ ">æ‰©å±•å­¦ä¹ </a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="ç›®æ ‡æ£€æµ‹ä»»åŠ¡1">ç›®æ ‡æ£€æµ‹ä»»åŠ¡ï¼ˆ1ï¼‰<a hidden class="anchor" aria-hidden="true" href="#ç›®æ ‡æ£€æµ‹ä»»åŠ¡1">#</a></h1>
<p>â›³æœ¬æŠ¥å‘Šä¸»è¦æ˜¯é’ˆå¯¹ç›®æ ‡æ£€æµ‹ä»»åŠ¡ä¸­<strong>æ­£è´Ÿæ ·æœ¬ä¸å¹³è¡¡</strong>ã€<strong>éš¾æ˜“æ ·æœ¬ä¸å¹³è¡¡</strong>è¿™ä¸¤ä¸ªé—®é¢˜è¿›è¡Œç®€è¦è®¨è®ºã€‚</p>
<h2 id="è®ºæ–‡ç®€ä»‹">è®ºæ–‡ç®€ä»‹<a hidden class="anchor" aria-hidden="true" href="#è®ºæ–‡ç®€ä»‹">#</a></h2>
<blockquote>
<p>Lin, T., Goyal, P., Girshick, R.B., <strong>He, K</strong>., &amp; DollÃ¡r, P. (2017). <strong>Focal Loss for Dense Object Detection</strong>. <em>2017 IEEE International Conference on Computer Vision (ICCV)</em>, 2999-3007.</p>
</blockquote>
<p><img loading="lazy" src="./20210827/14.png" alt=""  />
</p>
<ul>
<li>
<p>Focal Loss</p>
</li>
<li>
<p>ICCV 2017, Best student paper.</p>
</li>
<li>
<p><a href="https://arxiv.org/abs/1708.02002">https://arxiv.org/abs/1708.02002</a></p>
</li>
</ul>
<h2 id="1-èƒŒæ™¯">1. èƒŒæ™¯<a hidden class="anchor" aria-hidden="true" href="#1-èƒŒæ™¯">#</a></h2>
<p>ä»¥ 2014 å¹´ä¸ºåˆ†ç•Œï¼Œç›®æ ‡æ£€æµ‹çš„å‘å±•å†ç¨‹å¯ä»¥åˆ†ä¸ºä¸¤å¤§éƒ¨åˆ†ï¼š<strong>ä¼ ç»Ÿ</strong>ç›®æ ‡æ£€æµ‹æ—¶æœŸã€åŸºäº<strong>æ·±åº¦å­¦ä¹ </strong>çš„ç›®æ ‡æ£€æµ‹æ—¶æœŸã€‚</p>
<p><img loading="lazy" src="./20210827/1.png" alt=""  />
</p>
<blockquote>
<p>Zou, Z., Shi, Z., Guo, Y., &amp; Ye, J. (2019). Object Detection in 20 Years: A Survey. <em>ArXiv, abs/1905.05055</em>.</p>
</blockquote>
<p>åœ¨åŸºäºæ·±åº¦å­¦ä¹ çš„ç›®æ ‡æ£€æµ‹ç®—æ³•ä¸­ï¼Œåˆå¯ä»¥åˆ†ä¸ºå•é˜¶æ®µï¼ˆOne/Single-stageï¼‰å’Œä¸¤é˜¶æ®µï¼ˆTwo-stageï¼‰ä¸¤ç§å¤§ç±»ã€‚å½“ç„¶è¿˜æœ‰å¤šé˜¶æ®µï¼ˆMulti-stageï¼‰ï¼Œä½†æ˜¯å…¶é€Ÿåº¦å’Œç²¾åº¦éƒ½æ¯”è¾ƒä½ï¼Œå·²ç»è¢«æ·˜æ±°äº†ã€‚</p>
<h3 id="11-one-stage-and-two-stage">1.1 One-Stage and Two-stage<a hidden class="anchor" aria-hidden="true" href="#11-one-stage-and-two-stage">#</a></h3>
<p>One-stage å’Œ Two-stage çš„<strong>ä¸»è¦åŒºåˆ«</strong>åœ¨äºå—å¦å­˜åœ¨ Region Proposalï¼ˆå¯èƒ½åŒ…å«å¾…æ£€ç‰©ä½“çš„é¢„é€‰æ¡†ï¼‰æ“ä½œã€‚ä»¥ Two-stage æ–¹æ³•ä¸­çš„ä»£è¡¨ Faster RCNN ä¸ºä¾‹ï¼Œç®—æ³•ä¼šå…ˆç”Ÿæˆå€™é€‰æ¡†ï¼ˆRegion proposalsï¼Œå¯èƒ½åŒ…å«ç‰©ä½“çš„åŒºåŸŸï¼‰ï¼Œç„¶åå†å¯¹æ¯ä¸ªå€™é€‰æ¡†è¿›è¡Œåˆ†ç±»å’Œä¿®æ­£ä½ç½®ï¼›è€Œ One-stage ç®—æ³•ä¼šç›´æ¥åœ¨ç½‘ç»œä¸­æå–ç‰¹å¾æ¥é¢„æµ‹ç‰©ä½“åˆ†ç±»å’Œä½ç½®ã€‚</p>
<p>ä¸¤ç§æ–¹æ³•éƒ½å­˜åœ¨å„è‡ªçš„<strong>ä¼˜ç¼ºç‚¹</strong>ã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒOne-stage æ–¹æ³•åœ¨é€Ÿåº¦ä¸Šå­˜åœ¨ä¼˜åŠ¿ï¼Œä½†æ˜¯åœ¨ç²¾åº¦ä¸Šä¼šå·®äº Two-stageï¼Œä¸»è¦åŸå› å¯ä»¥æ€»ç»“ä¸ºï¼šæ­£è´Ÿæ ·æœ¬ä¸å¹³è¡¡ï¼ˆå’Œéš¾æ˜“æ ·æœ¬ä¸å¹³è¡¡ï¼‰é€ æˆäº† One-stage æ–¹æ³•åœ¨ç²¾åº¦ä¸Šçš„åŠ£åŠ¿ã€‚å…·ä½“åˆ†æå¦‚ä¸‹ï¼š</p>
<ul>
<li>
<p>One-stage ç½‘ç»œæœ€ç»ˆå­¦ä¹ çš„ Anchor æœ‰å¾ˆå¤šï¼Œä½†æ˜¯åªæœ‰å°‘æ•° Anchor å¯¹æœ€ç»ˆç½‘ç»œçš„å­¦ä¹ æ˜¯æœ‰åˆ©çš„ï¼Œè€Œå¤§éƒ¨åˆ† Anchor å¯¹æœ€ç»ˆç½‘ç»œçš„å­¦ä¹ éƒ½æ˜¯ä¸åˆ©çš„ï¼Œè¿™éƒ¨åˆ†çš„ Anchor å¾ˆå¤§ç¨‹åº¦ä¸Šå½±å“äº†æ•´ä¸ªç½‘ç»œçš„å­¦ä¹ ï¼Œæ‹‰ä½äº†æ•´ä½“çš„å‡†ç¡®ç‡ï¼›</p>
</li>
<li>
<p>Two-stage ç½‘ç»œæœ€ç»ˆå­¦ä¹ çš„ Anchor è™½ç„¶ä¸å¤šï¼Œä½†æ˜¯èƒŒæ™¯ Anchor ä¹Ÿå°±æ˜¯å¯¹ç½‘ç»œå­¦ä¹ ä¸åˆ©çš„ Anchor ä¹Ÿä¸ä¼šç‰¹åˆ«å¤šï¼Œå®ƒè™½ç„¶ä¹Ÿèƒ½å½±å“æ•´ä½“çš„å‡†ç¡®ç‡ï¼Œä½†æ˜¯è‚¯å®šæ²¡æœ‰ One-stage å½±å“å¾—é‚£ä¹ˆä¸¥é‡ï¼Œæ‰€ä»¥å®ƒçš„å‡†ç¡®ç‡æ¯” One-stage è‚¯å®šè¦é«˜ã€‚</p>
</li>
</ul>
<p>å¯¹äºæ­£è´Ÿæ ·æœ¬ä¸å¹³è¡¡é—®é¢˜ï¼Œæ˜¯æ¯”è¾ƒå¥½è§£å†³çš„ï¼Œä¹Ÿå­˜åœ¨ä¸å°‘çš„ç°æœ‰æ–¹æ³•ã€‚Focal Loss çš„æå‡ºï¼Œä¸»è¦é’ˆå¯¹<strong>éš¾æ˜“æ ·æœ¬çš„ä¸å¹³è¡¡é—®é¢˜</strong>ã€‚æœ‰äº† Focal Lossï¼Œè®­ç»ƒè¿‡ç¨‹å…³æ³¨å¯¹è±¡çš„æ¬¡åºä¸ºï¼šï¼ˆæ­£/éš¾ï¼‰ &gt; ï¼ˆè´Ÿ/éš¾ï¼‰ &gt; ï¼ˆæ­£/æ˜“ï¼‰ &gt; ï¼ˆè´Ÿ/æ˜“ï¼‰ã€‚è¯¥æŸå¤±å‡½æ•°<strong>é€šè¿‡æŠ‘åˆ¶é‚£äº›å®¹æ˜“åˆ†ç±»æ ·æœ¬çš„æƒé‡ï¼Œå°†æ³¨æ„åŠ›é›†ä¸­åœ¨é‚£äº›éš¾ä»¥åŒºåˆ†çš„æ ·æœ¬ä¸Šï¼Œæœ‰æ•ˆæ§åˆ¶æ­£è´Ÿæ ·æœ¬æ¯”ä¾‹ï¼Œé˜²æ­¢å¤±è¡¡ç°è±¡ã€‚</strong></p>
<p>============================================================</p>
<p>åœ¨å¼€å§‹ä»‹ç» Focal Loss ä¹‹å‰ï¼Œæˆ‘è¡¥å……ä¸€äº›ç›®æ ‡æ£€æµ‹çš„åŸºç¡€çŸ¥è¯†ï¼Œæˆ‘ä¹Ÿæ˜¯æ‰åˆšå¼€å§‹å­¦ä¹ ç›®æ ‡æ£€æµ‹ã€‚</p>
<p><strong>ï¼ˆ1ï¼‰ç›®æ ‡æ£€æµ‹ä¸­çš„å„ç§â€œæ¡†â€</strong></p>
<ul>
<li>ground truthï¼šæ ‡æ³¨æ¡†</li>
<li>Anchorï¼šäººä¸ºè®¾ç½®çš„åˆå§‹å…ˆéªŒæ¡†</li>
<li>proposalï¼šRPN çš„è¾“å‡ºï¼ˆå¯èƒ½åŒ…å«ç‰©ä½“çš„å€™é€‰æ¡†ï¼‰ï¼Œå³å¯¹ Anchor ç¬¬ä¸€æ¬¡åšå›å½’å¾—åˆ°çš„ç»“æœ</li>
<li>RoIï¼šRPN é˜¶æ®µè¾“å‡ºçš„ Proposal ç»è¿‡æ’åºå– topKï¼Œç„¶ååš NMS å–ä¸€å®šæ•°é‡çš„æ¡†ï¼Œç”¨äºç¬¬äºŒé˜¶æ®µçš„å†æ¬¡ç²¾ä¿®</li>
<li>bounding boxï¼šproposal ç»è¿‡å†æ¬¡ç²¾ä¿®åçš„é¢„æµ‹æ¡†ï¼Œç”±äºè®¡ç®— APï¼ŒAP æŒ‡çš„æ˜¯ bounding box APã€‚</li>
</ul>
<p><strong>ï¼ˆ2ï¼‰ç›®æ ‡æ£€æµ‹ä»»åŠ¡çš„è¯„ä¼°æŒ‡æ ‡ mAP</strong></p>
<p><a href="https://www.zhihu.com/question/53405779/answer/993913699">https://www.zhihu.com/question/53405779/answer/993913699</a></p>
<p>APï¼šPR æ›²çº¿ä¸‹é¢ç§¯ï¼Œå…ˆè€ƒè™‘è®¡ç®— APï¼Œå³ä¸€ä¸ªç±»åˆ«ã€‚</p>
<p><img loading="lazy" src="./20210827/2.png" alt=""  />
</p>
<ul>
<li>7 å¼ å›¾åƒï¼ˆå‡è®¾æ˜¯ä¸€ä¸ª Batchï¼‰ï¼Œ15 ä¸ª <!-- raw HTML omitted -->ground truth<!-- raw HTML omitted -->ï¼Œ24 ä¸ª<!-- raw HTML omitted -->é¢„æµ‹æ¡†<!-- raw HTML omitted --></li>
<li>ï¼ˆ1ï¼‰è®¡ç®—é¢„æµ‹æ¡†æ˜¯ TP or FPï¼ˆè®¡ç®— bbox ä¸ Ground truth çš„ IoUï¼Œæ ¹æ®é˜ˆå€¼åˆ¤æ–­ï¼‰ï¼Œå¦‚æœä¸€ä¸ª Ground Truth æœ‰å¤šä¸ªé¢„æµ‹æ¡†ï¼Œåˆ™ IoU æœ€å¤§ä¸º TPï¼Œå…¶ä»–ä¸º FPï¼›</li>
<li>ï¼ˆ2ï¼‰æ ¹æ®ç½®ä¿¡åº¦ä»å¤§åˆ°å°æ’åºæ‰€æœ‰çš„é¢„æµ‹æ¡†ï¼›</li>
<li>ï¼ˆ3ï¼‰è®¡ç®— Precision = TP / (ACC_TP + ACC_FP)ã€Recall = TP / (<code>all grouth truth</code>)ï¼›
<ul>
<li>ACC è¡¨ç¤ºç´¯åŠ ï¼Œ<code>all ground truth</code> æ˜¯ä¸€ä¸ªå›ºå®šå€¼</li>
</ul>
</li>
<li>ï¼ˆ4ï¼‰ç»˜åˆ¶ PR æ›²çº¿ï¼›</li>
<li>ï¼ˆ5ï¼‰è®¡ç®—æ›²çº¿ä¸‹çš„é¢ç§¯ï¼Œ11 ä¸ªç‚¹ <strong>[0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1]</strong> çš„æ’å€¼è¿›è¡Œè®¡ç®—ï¼ˆ10 ä¸ªçŸ©å½¢çš„é¢ç§¯ä¹‹å’Œï¼‰</li>
<li>ï¼ˆ6ï¼‰æ‰€æœ‰ç±»åˆ«çš„ AP è®¡ç®—éƒ½åˆ†åˆ«å‡ºæ¥ï¼Œç„¶åæ±‚å–å¹³å‡å¾—åˆ° mAPã€‚</li>
</ul>
<h2 id="2-focal-loss">2. Focal Loss<a hidden class="anchor" aria-hidden="true" href="#2-focal-loss">#</a></h2>
<p>å…ˆä»äºŒåˆ†ç±»çš„äº¤å‰ç†µå¼€å§‹ï¼š</p>
<p><img loading="lazy" src="./20210827/3.png" alt=""  />
</p>
<ul>
<li>$y \in {\pm 1}$ ä»£è¡¨ ground truthï¼ˆçœŸå®å€¼ï¼‰</li>
<li>$p \in [0, 1]$  è¡¨ç¤ºæ¨¡å‹è¾“å‡ºæ ‡ç­¾ä¸º 1 çš„æ¦‚ç‡ï¼ˆé¢„æµ‹å€¼ï¼‰</li>
</ul>
<p>å®šä¹‰ä¸€ä¸ª $p_t$ï¼š</p>
<p><img loading="lazy" src="./20210827/4.png" alt=""  />
</p>
<p>åˆ™äº¤å‰ç†µå¯ä»¥å†™ä¸º $CE(p, y) = CE(p_t) = -log(p_t)$</p>
<p>äº¤å‰ç†µæŸå¤±å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚ Figure 1.ï¼Œå³ä½¿é‚£äº›å¾ˆå®¹æ˜“ easily classified çš„æ ·æœ¬ï¼ˆ$p_t &raquo; 0.5$ï¼‰ï¼Œä»ä¼šé€ æˆå¾ˆæ˜¾è‘—çš„æŸå¤±å€¼ã€‚å½“è¿™äº› easy example æ•°é‡åºå¤§æ—¶ï¼Œå…¶ç´¯è®¡èµ·æ¥çš„æŸå¤±å¯èƒ½ä¼šè¿œè¿œå¤§äºï¼ˆoverwhelmï¼‰é‚£äº› rare classã€‚</p>
<blockquote>
<p>æˆ‘è®¤ä¸ºè¿™å¾ˆç±»ä¼¼äºæ”¿æ²»ä¸Šçš„æ°‘ä¸»æš´æ”¿ã€‚</p>
</blockquote>
<p><img loading="lazy" src="./20210827/5.png" alt=""  />
</p>
<h3 id="21-balanced-cross-entropy">2.1 Balanced Cross Entropy<a hidden class="anchor" aria-hidden="true" href="#21-balanced-cross-entropy">#</a></h3>
<p>è§£å†³æ­£è´Ÿæ ·æœ¬ä¸å¹³è¡¡çš„å¸¸ç”¨æ–¹æ³•æ˜¯å¯¹ç±»åˆ« 1 å¼•å…¥æƒé‡å› å­ Î±âˆˆ[0,1]ï¼Œå¯¹ç±»åˆ« -1 å¼•å…¥æƒé‡å› å­ 1-Î±ã€‚å¾—åˆ° Î±-balanced CE lossï¼š</p>
<p><img loading="lazy" src="./20210827/6.png" alt=""  />
</p>
<p>å³ï¼Œ</p>
<p><img loading="lazy" src="./20210827/7.png" alt=""  />
</p>
<h3 id="22-focal-loss">2.2 Focal Loss<a hidden class="anchor" aria-hidden="true" href="#22-focal-loss">#</a></h3>
<p>Easily classified negatives comprise the <strong>majority of the loss and dominate the gradient</strong>. Î± balances the importance of positive/negative examples, it does not differentiate between easy/hard examples.</p>
<p>å› æ­¤ï¼ŒFocal Loss çš„ä¸»è¦ç›®æ ‡æ˜¯ down-weight easy exampleï¼Œä½¿å¾—èƒ½å¤Ÿ focus training on <!-- raw HTML omitted -->hard example<!-- raw HTML omitted -->ã€‚Focal Loss å®šä¹‰å¦‚ä¸‹ï¼š</p>
<p><img loading="lazy" src="./20210827/8.png" alt=""  />
</p>
<ul>
<li>$(1 - p_t)^{\gamma}$ æ˜¯ modulating factorï¼ˆè°ƒèŠ‚å› å­ï¼‰</li>
<li>$\gamma$ æ˜¯ä¸€ä¸ªå¯è°ƒèŠ‚çš„è¶…å‚æ•°ï¼Œ<em>focusing</em> parameterï¼ˆèšç„¦å‚æ•°ï¼‰</li>
</ul>
<p>Focal Loss æœ‰ä¸¤ä¸ªæ€§è´¨ï¼š</p>
<p>ï¼ˆ1ï¼‰å½“ä¸€ä¸ªæ ·æœ¬å‡ºç°äº†é”™è¯¯åˆ†ç±»ï¼Œä¸” $p_t$ éå¸¸å°ï¼Œåˆ™ $(1 - p_t)^{\gamma}$ éå¸¸æ¥è¿‘ 1ï¼ŒLoss ä¸å—å½±å“ï¼›å½“ $p_t$ æ¥è¿‘äº 1 æ—¶ï¼Œ$(1 - p_t)^{\gamma}$ æ¥è¿‘ 0ï¼Œå¯¹äº well-classified examples çš„ Loss å°†ä¼šé™ä½æƒé‡ï¼ˆdown-weightedï¼‰ã€‚å› æ­¤æ¨¡å‹çš„ Loss å°±é›†ä¸­åœ¨é‚£äº›é”™è¯¯åˆ†ç±»æ ·æœ¬ä¸Šäº†ï¼ˆhard exampleï¼‰ã€‚</p>
<p>ï¼ˆ2ï¼‰Focusing parameter $\gamma$ ç”¨äºè°ƒæ•´ç®€å•çš„æ ·æœ¬ï¼ˆeasy examples, well-classified examplesï¼‰çš„ Loss é™ä½æƒé‡ï¼ˆdown-weightedï¼‰çš„é€Ÿç‡ã€‚$\gamma=0$ æ—¶ï¼ŒFL == CEï¼›$\gamma = 2$ æ˜¯å®éªŒå¾—åˆ°çš„æœ€å¥½å€¼ã€‚</p>
<p>Intuitively, the modulating factor <strong>reduces the loss contribution from easy examples</strong> and extends the range in which an example receives low loss.</p>
<p>ä¾‹å¦‚ï¼š</p>
<ul>
<li>$\gamma = 2$ï¼Œä¸€ä¸ªæ ·æœ¬çš„åˆ†ç±»ç»“æœä¸º $p_t = 0.9$ï¼ˆè¿™å°±æ˜¯ä¸€ä¸ª easy exampleï¼‰ï¼Œåˆ™ $(1 - 0.9)^{2} = 0.01$ã€‚Focal Loss æ¯” CE å° 100 å€ï¼›</li>
<li>$p_t = 0.968$ æ—¶ï¼ŒFL æ¯” CE å°è¿‘ 1000 å€ã€‚</li>
<li>åŒç†ï¼Œ$p_t = 0.4$ æ—¶ï¼ˆhard exampleï¼‰ï¼Œåˆ™ $(1 - 0.4)^{2} = 0.36$ã€‚ç›¸å½“äºå˜ç›¸ç»™é”™è¯¯åˆ†ç±»çš„éš¾æ ·æœ¬çš„ Loss å¢åŠ äº†æƒé‡ã€‚â€œincreases the importance of correcting misclassifified examplesâ€</li>
</ul>
<p>ä¸ºäº†å¹³è¡¡æ­£è´Ÿæ ·æœ¬ï¼Œä½¿ç”¨ Î± æƒé‡ï¼Œå¾—åˆ°æœ€ç»ˆçš„ Focal Loss è¡¨è¾¾å¼ï¼š</p>
<p><img loading="lazy" src="./20210827/9.png" alt=""  />
</p>
<p>FL æ›´åƒæ˜¯ä¸€ç§æ€æƒ³ï¼Œå…¶ç²¾ç¡®çš„å®šä¹‰å½¢å¼å¹¶ä¸é‡è¦ã€‚</p>
<p>åœ¨ Two-stage æ–¹æ³•ä¸­ï¼Œå¯¹äºæ­£è´Ÿæ ·æœ¬ä¸å¹³è¡¡é—®é¢˜ï¼Œä¸»è¦æ˜¯é€šè¿‡å¦‚ä¸‹æ–¹æ³•ç¼“è§£ï¼š</p>
<ul>
<li>ï¼ˆ1ï¼‰object proposal mechanismï¼šreduces the nearly infifinite set of possible object locations down to one or two thousand.</li>
<li>ï¼ˆ2ï¼‰ biased samplingï¼š1:3 ratio of positive to negative examples.</li>
</ul>
<p>åŒæ—¶ï¼Œåœ¨æ¨¡å‹åˆå§‹åŒ–æ—¶ï¼Œå¯ä»¥åŠ å…¥ä¸€ä¸‹å…ˆéªŒçŸ¥è¯†ï¼Œå¯ä»¥ç¼“è§£è®­ç»ƒåˆæœŸçš„ä¸ç¨³å®šç°è±¡ã€‚FL é€šè¿‡ç›´æ¥é€šè¿‡æŸå¤±å‡½æ•°è§£å†³ï¼</p>
<p>Focal Loss çš„ä»£ç å¯ä»¥å‚è€ƒ MMdetectionï¼šhttps://github.com/open-mmlab/mmdetection/blob/master/mmdet/models/losses/focal_loss.py</p>
<h2 id="3-retinanet">3. RetinaNet<a hidden class="anchor" aria-hidden="true" href="#3-retinanet">#</a></h2>
<p>ä¸ºäº†éªŒè¯ Focal loss çš„æœ‰æ•ˆæ€§ï¼Œè®¾è®¡äº†ä¸€ä¸ªå« RetinaNet çš„ç½‘ç»œè¿›è¡Œè¯„ä¼°ã€‚å®éªŒç»“æœè¡¨æ˜ï¼ŒRetinaNet èƒ½å¤Ÿåœ¨å®ç°ä¿æŒ one-stage é€Ÿåº¦ä¼˜åŠ¿çš„åŸºç¡€ä¸Šï¼Œåœ¨ç²¾åº¦ä¸Šè¶…è¶Šæ‰€æœ‰ï¼ˆ2017 å¹´ï¼‰two-stage çš„æ£€æµ‹å™¨ï¼ˆ achieves state-of-the-art accuracy and run time on the challenging COCO datasetï¼‰ã€‚</p>
<p>RetinaNet çš„å·ç§¯è¿‡ç¨‹ç”¨çš„æ˜¯ ResNetï¼Œä¸Šé‡‡æ ·å’Œä¾§è¾¹è¿æ¥è¿˜æ˜¯ FPN ç»“æ„ã€‚é€šè¿‡ä¸»å¹²ç½‘ç»œï¼Œäº§ç”Ÿäº†å¤šå°ºåº¦çš„ç‰¹å¾é‡‘å­—å¡”ã€‚ç„¶ååé¢è¿æ¥ä¸¤ä¸ªå­ç½‘ï¼Œåˆ†åˆ«è¿›è¡Œåˆ†ç±»å’Œå›å½’ã€‚</p>
<p><img loading="lazy" src="./20210827/10.png" alt=""  />
</p>
<h2 id="4-å®éªŒç»“æœ">4 å®éªŒç»“æœ<a hidden class="anchor" aria-hidden="true" href="#4-å®éªŒç»“æœ">#</a></h2>
<p>ä½œè€…åšäº†å¾ˆå¤šæ¶ˆèå­¦ä¹ ï¼Œå¯ä»¥æ€»ç»“å¦‚ä¸‹ï¼š</p>
<ul>
<li>ä½œè€…æœ‰å¾ˆå¤šå¡ï¼›</li>
<li>$\alpha$ å’Œ $\gamma$ è¿™ä¸¤ä¸ªè¶…å‚æ•°æ˜¯äº’ç›¸å½±å“çš„ï¼›</li>
<li>Focal loss çš„å¨åŠ›è¿˜æ˜¯å¾ˆå¤§çš„ï¼›</li>
<li>$\gamma=2, \alpha=0.25$ æ—¶ï¼ŒResNet-101+FPN ä½œä¸º backbone çš„ç»“æ„æœ‰æœ€ä¼˜çš„æ€§èƒ½ï¼›</li>
</ul>
<p>ä¸‹å›¾æ˜¯æ”¶æ•›æ¨¡å‹ä¸­ä¸åŒ Î³ å€¼çš„æ­£è´Ÿæ ·æœ¬å½’ä¸€åŒ–æŸå¤±çš„ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ã€‚</p>
<p><img loading="lazy" src="./20210827/11.png" alt=""  />
</p>
<p>æ”¹å˜ Î³ å¯¹æ­£æ ·æœ¬çš„æŸå¤±åˆ†å¸ƒçš„å½±å“å¾ˆå°ã€‚ç„¶è€Œï¼Œå¯¹äºè´Ÿæ ·æœ¬ï¼Œå¢åŠ  Î³ ä¼šä½¿å¾—æ¨¡å‹å‡ ä¹æ‰€æœ‰çš„æ³¨æ„åŠ›ä»è´Ÿæ ·æœ¬ä¸Šç¦»å¼€ï¼Œå®ç°äº† down-weight easy exampleã€‚</p>
<p>Focal Loss ä½¿å¾— One-stage æ–¹æ³•åœ¨ç²¾åº¦ä¸Šè¶…è¶Šäº† Two-stage æ–¹æ³•ã€‚</p>
<p><img loading="lazy" src="./20210827/12.png" alt=""  />
</p>
<p>Focal Loss çš„ç¼ºç‚¹ï¼šåœ¨é€Ÿåº¦ä¸Šè¿˜å­˜åœ¨å¾ˆå¤§çš„æ”¹è¿›ç©ºé—´ã€‚</p>
<p><img loading="lazy" src="./20210827/13.png" alt=""  />
</p>
<h2 id="æ€»ç»“">æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#æ€»ç»“">#</a></h2>
<ul>
<li>
<p>One-stage æ–¹æ³•ç›¸æ¯”äº Two-stage æ–¹æ³•ï¼Œåœ¨ç²¾åº¦ç¨æœ‰åŠ£åŠ¿ã€‚ç ”ç©¶å‘ç°ï¼Œæ˜¯<strong>æ­£è´Ÿæ ·æœ¬ä¸å¹³è¡¡</strong>å’Œ<strong>éš¾æ˜“æ ·æœ¬ä¸å¹³è¡¡</strong>è¿™ä¸¤ä¸ªé—®é¢˜æ‰€å¯¼è‡´çš„ï¼›</p>
</li>
<li>
<p>Focal Loss å‡½æ•°<strong>é€šè¿‡æŠ‘åˆ¶é‚£äº›å®¹æ˜“åˆ†ç±»æ ·æœ¬çš„æƒé‡ï¼Œå°†æ³¨æ„åŠ›é›†ä¸­åœ¨é‚£äº›éš¾ä»¥åŒºåˆ†çš„æ ·æœ¬ä¸Šï¼Œæœ‰æ•ˆæ§åˆ¶æ­£è´Ÿæ ·æœ¬æ¯”ä¾‹ï¼Œé˜²æ­¢å¤±è¡¡ç°è±¡ã€‚</strong></p>
</li>
<li>
<p>Focal Loss çš„ä¸»è¦ç›®æ ‡æ˜¯ down-weight easy exampleï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿ focus training on <!-- raw HTML omitted -->hard example<!-- raw HTML omitted -->ã€‚</p>
</li>
<li>
<p>å…·ä½“åšæ³•æ˜¯ï¼Œå¯¹äºéš¾æ˜“æ ·æœ¬ä¸å¹³è¡¡é—®é¢˜ï¼Œå¼•å…¥ modulating factor $(1 - p_t)^{\gamma}$ï¼Œ Intuitively, the modulating factor <strong>reduces the loss contribution from easy examples</strong> and extends the range in which an example receives low loss.</p>
</li>
<li>
<p>ä¸ºäº†éªŒè¯ Focal Loss çš„æœ‰æ•ˆæ€§ï¼Œè®¾è®¡äº† RetinaNet ç”¨äºå®éªŒè¯„ä¼°ã€‚</p>
</li>
<li>
<p>RetinaNet èƒ½å¤Ÿåœ¨å®ç°ä¿æŒ one-stage é€Ÿåº¦ä¼˜åŠ¿çš„åŸºç¡€ä¸Šï¼Œåœ¨ç²¾åº¦ä¸Šè¶…è¶Šæ‰€æœ‰ï¼ˆ2017 å¹´ï¼‰two-stage çš„æ£€æµ‹å™¨ï¼ˆ achieves state-of-the-art accuracy and run time on the challenging COCO datasetï¼‰ã€‚</p>
</li>
<li>
<p>RetinaNet ä¹Ÿå­˜åœ¨ç¼ºç‚¹ï¼Œå…¶åœ¨é€Ÿåº¦ä¸Šä»æœ‰å¾ˆå¤§çš„æ”¹è¿›ç©ºé—´ã€‚</p>
</li>
</ul>
<h2 id="æ‰©å±•å­¦ä¹ ">æ‰©å±•å­¦ä¹ <a hidden class="anchor" aria-hidden="true" href="#æ‰©å±•å­¦ä¹ ">#</a></h2>
<p>Focal Loss å­˜åœ¨ç¼ºç‚¹ï¼š</p>
<ul>
<li>è®©æ¨¡å‹<strong>è¿‡å¤šå…³æ³¨é‚£äº›ç‰¹åˆ«éš¾åˆ†çš„æ ·æœ¬</strong>è‚¯å®šæ˜¯å­˜åœ¨é—®é¢˜çš„ï¼Œæ ·æœ¬ä¸­æœ‰<strong>ç¦»ç¾¤ç‚¹ï¼ˆoutliersï¼‰</strong>ï¼Œå¯èƒ½æ¨¡å‹å·²ç»æ”¶æ•›äº†ä½†æ˜¯è¿™äº›ç¦»ç¾¤ç‚¹è¿˜æ˜¯ä¼šè¢«åˆ¤æ–­é”™è¯¯ï¼Œè®©æ¨¡å‹å»å…³æ³¨è¿™æ ·çš„æ ·æœ¬ï¼Œå¯èƒ½å¯¹æœ€åçš„ç»“æœé€ æˆä¸åˆ©çš„å½±å“ï¼›</li>
<li>$\alpha$ å’Œ $\gamma$ äº’ç›¸å½±å“ï¼Œå…¨å‡­ç»éªŒå¾—åˆ°ï¼ˆä¸åŒçš„æ•°æ®é›†éƒ½è¦å¯»æ‰¾çš„æœ€ä½³çš„ $\alpha, \gamma$ï¼Œ<strong>ä»£ä»·æ˜‚è´µ</strong>ï¼‰ï¼›</li>
<li>é€Ÿåº¦ä¸Šä»å­˜åœ¨æ”¹è¿›ç©ºé—´ã€‚</li>
</ul>
<p>ï¼ˆ1ï¼‰GHM(gradient harmonizing mechanism) è§£å†³äº†ä¸Šè¿°å‰ä¸¤ä¸ªé—®é¢˜ã€‚Focal Loss æ˜¯ä»<strong>ç½®ä¿¡åº¦ p <strong>çš„è§’åº¦å…¥æ‰‹è¡°å‡ Lossï¼Œè€Œ GHM æ˜¯</strong>ä¸€å®šèŒƒå›´ç½®ä¿¡åº¦pçš„æ ·æœ¬æ•°é‡</strong>çš„è§’åº¦è¡°å‡ Lossã€‚</p>
<p>ï¼ˆ2ï¼‰Generalized Focal Lossï¼Œä¸ä¼šå¸¦æ¥é¢å¤–çš„ Costï¼Œæå‡ 1% çš„ APã€‚</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://landodo.github.io/tags/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">è®ºæ–‡é˜…è¯»</a></li>
      <li><a href="http://landodo.github.io/tags/%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B/">ç›®æ ‡æ£€æµ‹</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://landodo.github.io/posts/20210831-structure-boundary-preserving-segmentation/">
    <span class="title">Â« Prev Page</span>
    <br>
    <span>Structure Boundary Preserving Segmentation for Medical Image with Ambiguous Boundary</span>
  </a>
  <a class="next" href="http://landodo.github.io/posts/20210824-object-detection-anchor/">
    <span class="title">Next Page Â»</span>
    <br>
    <span>å…³äº Object Detection Anchor çš„å­¦ä¹ ç¬”è®°</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>Landon</span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
