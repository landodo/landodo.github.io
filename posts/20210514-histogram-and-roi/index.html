<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


<meta name="robots" content="index, follow">
<title>绘制频率直方图 | Notes</title>
<meta name="keywords" content="Python, Pillow" />
<meta name="description" content="!ls Histogram and RoI.ipynb axon02.tif test.jpg Question 2.1 .ipynb cell_nucleus.tif axon01.tif roi.tif from PIL import Image import numpy as np from PIL import ImageOps import matplotlib.pyplot as plt # 打开图片并转换成灰度图 im = Image.open(&#39;axon01.tif&#39;).convert(&#39;L&#39;) # 反转颜色 im = ImageOps.invert(im) # display in macOS /Applications/Preview.app # im.show() # display in Jupyter Notebook im ​ ​ # 将灰度">
<meta name="author" content="">
<link rel="canonical" href="http://landodo.github.io/posts/20210514-histogram-and-roi/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css" integrity="sha256-yIlj/i15RiAA/Q&#43;xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as="style">
<link rel="preload" href="./logo.png" as="image">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js" integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="http://landodo.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://landodo.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://landodo.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://landodo.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="http://landodo.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="绘制频率直方图" />
<meta property="og:description" content="!ls Histogram and RoI.ipynb axon02.tif test.jpg Question 2.1 .ipynb cell_nucleus.tif axon01.tif roi.tif from PIL import Image import numpy as np from PIL import ImageOps import matplotlib.pyplot as plt # 打开图片并转换成灰度图 im = Image.open(&#39;axon01.tif&#39;).convert(&#39;L&#39;) # 反转颜色 im = ImageOps.invert(im) # display in macOS /Applications/Preview.app # im.show() # display in Jupyter Notebook im ​ ​ # 将灰度" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://landodo.github.io/posts/20210514-histogram-and-roi/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-05-14T22:53:19&#43;08:00" />
<meta property="article:modified_time" content="2021-05-14T22:53:19&#43;08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="绘制频率直方图"/>
<meta name="twitter:description" content="!ls Histogram and RoI.ipynb axon02.tif test.jpg Question 2.1 .ipynb cell_nucleus.tif axon01.tif roi.tif from PIL import Image import numpy as np from PIL import ImageOps import matplotlib.pyplot as plt # 打开图片并转换成灰度图 im = Image.open(&#39;axon01.tif&#39;).convert(&#39;L&#39;) # 反转颜色 im = ImageOps.invert(im) # display in macOS /Applications/Preview.app # im.show() # display in Jupyter Notebook im ​ ​ # 将灰度"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://landodo.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "绘制频率直方图",
      "item": "http://landodo.github.io/posts/20210514-histogram-and-roi/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "绘制频率直方图",
  "name": "绘制频率直方图",
  "description": "!ls Histogram and RoI.ipynb axon02.tif test.jpg Question 2.1 .ipynb cell_nucleus.tif axon01.tif roi.tif from PIL import Image import numpy as np from PIL import ImageOps import matplotlib.pyplot as plt # 打开图片并转换成灰度图 im = Image.open(\u0026#39;axon01.tif\u0026#39;).convert(\u0026#39;L\u0026#39;) # 反转颜色 im = ImageOps.invert(im) # display in macOS /Applications/Preview.app # im.show() # display in Jupyter Notebook im ​ ​ # 将灰度",
  "keywords": [
    "Python", "Pillow"
  ],
  "articleBody": "!ls Histogram and RoI.ipynb axon02.tif test.jpg Question 2.1 .ipynb cell_nucleus.tif axon01.tif roi.tif  from PIL import Image import numpy as np from PIL import ImageOps import matplotlib.pyplot as plt # 打开图片并转换成灰度图 im = Image.open('axon01.tif').convert('L') # 反转颜色 im = ImageOps.invert(im) # display in macOS /Applications/Preview.app # im.show()  # display in Jupyter Notebook im ​ ​\n# 将灰度图片转换为 Numpy Array im2array = np.array(im) im2array.shape (204, 1392)  # 将矩阵转化为向量 im2array = im2array.flatten() # 204*1392 = 283968 len(im2array) 283968  # 统计灰度值频率 freq = [0]*256 for i in range(len(im2array)):  freq[im2array[i]] += 1 # 绘制灰度频率直方图 plt.figure(figsize=(25,10)) for i in range(0, 256):  plt.bar(i, freq[i], color='r')  plt.grid(color='gray', linewidth=0.1) ​ ​\n# 左上角坐标(0,0)，右下角下标(100,100) # 裁剪出 100*100 的区域 box = (0, 0, 100, 100) region = im.crop(box) # 保存 region.save('roi.tif') # 读取保存的 RoI roi_im = Image.open('./roi.tif') roi_im.size (100, 100)  # 不转换为灰度图片 im = Image.open('axon01.tif') im2array = np.array(im) im2array = im2array.flatten()  # 统计像素值对应的像素个数 hist = [0] * (np.max(im2array)+1) for i in range(0, len(im2array)):  hist[im2array[i]] += 1 # 绘制直方图 plt.figure(figsize=(25,10)) for i in range(0, np.max(im2array)):  plt.bar(i, hist[i], color='r')  plt.grid(color='gray', linewidth=0.1) ​ ​\n使用 Pillow 库绘制直方图 # 求[0,255]像素频率 histogram = im.histogram() # 这个分布符合直觉，大部分都是黑色 print(histogram) [3341, 138883, 751, 581, 499, 536, 582, 11, 645, 687, 717, 774, 800, 895, 946, 1071, 1367, 6, 1131, 1178, 1212, 1256, 1384, 1407, 1491, 1548, 1649, 5, 1726, 1760, 1855, 1869, 1982, 2007, 1993, 2027, 2069, 3, 2161, 2230, 2316, 2194, 2337, 2293, 2304, 2316, 2427, 6, 2474, 2341, 2359, 2380, 2380, 2301, 3120, 2300, 2175, 1, 2208, 2151, 2059, 2089, 2068, 1994, 1891, 1957, 1775, 3, 1753, 1725, 1676, 1718, 1527, 1527, 1490, 1361, 1281, 4, 1718, 1254, 1101, 1092, 1027, 974, 894, 896, 796, 3, 820, 727, 720, 650, 670, 585, 548, 498, 487, 1, 442, 400, 387, 335, 339, 345, 293, 279, 220, 4, 235, 224, 227, 189, 196, 173, 165, 244, 147, 3, 118, 113, 109, 109, 109, 110, 98, 74, 76, 2, 75, 77, 74, 69, 73, 57, 75, 67, 56, 2, 57, 44, 63, 57, 47, 36, 38, 35, 40, 1, 43, 28, 41, 29, 34, 34, 26, 33, 21, 1, 35, 32, 8, 22, 38, 19, 34, 32, 33, 0, 20, 22, 10, 26, 16, 19, 11, 21, 12, 1, 23, 12, 29, 20, 10, 13, 7, 11, 19, 1, 18, 14, 6, 18, 13, 13, 9, 14, 10, 2, 10, 11, 13, 12, 10, 9, 11, 14, 4, 1, 15, 13, 12, 15, 10, 3, 11, 9, 9, 4, 14, 14, 15, 17, 16, 15, 19, 18, 16, 15, 19, 25, 34, 35, 32, 9, 45, 49, 54, 47, 65, 85, 101, 108, 92, 5, 102, 149, 141, 157, 185, 201, 207, 222, 275, 6, 318, 297]  # 最大值 138883 表示有 138883 个值为 1的像素 max(histogram) 138883  for i, value in enumerate(im.histogram()):  print(i, value) 0 3341 1 138883 2 751 3 581 4 499 5 536 6 582 7 11 8 645 9 687 10 717 11 774 12 800 13 895 14 946 15 1071 16 1367 17 6 18 1131 19 1178 20 1212 21 1256 22 1384 23 1407 24 1491 25 1548 26 1649 27 5 28 1726 29 1760 30 1855 31 1869 32 1982 33 2007 34 1993 35 2027 36 2069 37 3 38 2161 39 2230 40 2316 41 2194 42 2337 43 2293 44 2304 45 2316 46 2427 47 6 48 2474 49 2341 50 2359 51 2380 52 2380 53 2301 54 3120 55 2300 56 2175 57 1 58 2208 59 2151 60 2059 61 2089 62 2068 63 1994 64 1891 65 1957 66 1775 67 3 68 1753 69 1725 70 1676 71 1718 72 1527 73 1527 74 1490 75 1361 76 1281 77 4 78 1718 79 1254 80 1101 81 1092 82 1027 83 974 84 894 85 896 86 796 87 3 88 820 89 727 90 720 91 650 92 670 93 585 94 548 95 498 96 487 97 1 98 442 99 400 100 387 101 335 102 339 103 345 104 293 105 279 106 220 107 4 108 235 109 224 110 227 111 189 112 196 113 173 114 165 115 244 116 147 117 3 118 118 119 113 120 109 121 109 122 109 123 110 124 98 125 74 126 76 127 2 128 75 129 77 130 74 131 69 132 73 133 57 134 75 135 67 136 56 137 2 138 57 139 44 140 63 141 57 142 47 143 36 144 38 145 35 146 40 147 1 148 43 149 28 150 41 151 29 152 34 153 34 154 26 155 33 156 21 157 1 158 35 159 32 160 8 161 22 162 38 163 19 164 34 165 32 166 33 167 0 168 20 169 22 170 10 171 26 172 16 173 19 174 11 175 21 176 12 177 1 178 23 179 12 180 29 181 20 182 10 183 13 184 7 185 11 186 19 187 1 188 18 189 14 190 6 191 18 192 13 193 13 194 9 195 14 196 10 197 2 198 10 199 11 200 13 201 12 202 10 203 9 204 11 205 14 206 4 207 1 208 15 209 13 210 12 211 15 212 10 213 3 214 11 215 9 216 9 217 4 218 14 219 14 220 15 221 17 222 16 223 15 224 19 225 18 226 16 227 15 228 19 229 25 230 34 231 35 232 32 233 9 234 45 235 49 236 54 237 47 238 65 239 85 240 101 241 108 242 92 243 5 244 102 245 149 246 141 247 157 248 185 249 201 250 207 251 222 252 275 253 6 254 318 255 297  # 像素总数 283968 = 204*1392 np.sum(histogram) 283968  # 灰度级在 [0,255] len(histogram) 256  plt.figure(figsize=(50,30)) for i in range(0, 256):  plt.bar(i, histogram[i], color='r')  plt.grid(color='gray', linewidth=0.1) ​ ​\n",
  "wordCount" : "1132",
  "inLanguage": "en",
  "datePublished": "2021-05-14T22:53:19+08:00",
  "dateModified": "2021-05-14T22:53:19+08:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://landodo.github.io/posts/20210514-histogram-and-roi/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Notes",
    "logo": {
      "@type": "ImageObject",
      "url": "http://landodo.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://landodo.github.io/" accesskey="h" title="Notes (Alt + H)">
                <img src="http://landodo.github.io/logo.png" alt="logo" aria-label="logo"
                    height="30">Notes</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="http://landodo.github.io/search" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://landodo.github.io/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="http://landodo.github.io/archives/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="http://landodo.github.io/tags" title="Tag">
                    <span>Tag</span>
                </a>
            </li>
            <li>
                <a href="http://landodo.github.io/about" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="http://landodo.github.io/cs-zoo" title="CS ZOO">
                    <span>CS ZOO</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://landodo.github.io/">Home</a>&nbsp;»&nbsp;<a href="http://landodo.github.io/posts/">Posts</a></div>
    <h1 class="post-title">
      绘制频率直方图
    </h1>
    <div class="post-meta"><span title='2021-05-14 22:53:19 +0800 CST'>May 14, 2021</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;1132 words

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8-pillow-%e5%ba%93%e7%bb%98%e5%88%b6%e7%9b%b4%e6%96%b9%e5%9b%be" aria-label="使用 Pillow 库绘制直方图">使用 Pillow 库绘制直方图</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>ls
</span></span></code></pre></div><pre><code>Histogram and RoI.ipynb axon02.tif              test.jpg
Question 2.1 .ipynb     cell_nucleus.tif
axon01.tif              roi.tif
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> PIL <span style="color:#f92672">import</span> Image
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> PIL <span style="color:#f92672">import</span> ImageOps
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 打开图片并转换成灰度图</span>
</span></span><span style="display:flex;"><span>im <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>open(<span style="color:#e6db74">&#39;axon01.tif&#39;</span>)<span style="color:#f92672">.</span>convert(<span style="color:#e6db74">&#39;L&#39;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 反转颜色</span>
</span></span><span style="display:flex;"><span>im <span style="color:#f92672">=</span> ImageOps<span style="color:#f92672">.</span>invert(im)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># display in macOS /Applications/Preview.app</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># im.show()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># display in Jupyter Notebook</span>
</span></span><span style="display:flex;"><span>im
</span></span></code></pre></div><p>​ <br>
<img loading="lazy" src="./20210514/hist_output_4_0.png" alt="png"  />

​</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 将灰度图片转换为 Numpy Array</span>
</span></span><span style="display:flex;"><span>im2array <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(im)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>im2array<span style="color:#f92672">.</span>shape
</span></span></code></pre></div><pre><code>(204, 1392)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 将矩阵转化为向量</span>
</span></span><span style="display:flex;"><span>im2array <span style="color:#f92672">=</span> im2array<span style="color:#f92672">.</span>flatten()
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 204*1392 = 283968</span>
</span></span><span style="display:flex;"><span>len(im2array)
</span></span></code></pre></div><pre><code>283968
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 统计灰度值频率</span>
</span></span><span style="display:flex;"><span>freq <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span><span style="color:#ae81ff">256</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(im2array)):
</span></span><span style="display:flex;"><span>    freq[im2array[i]] <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 绘制灰度频率直方图</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">25</span>,<span style="color:#ae81ff">10</span>))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">256</span>):
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>bar(i, freq[i], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;r&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>grid(color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">0.1</span>)
</span></span></code></pre></div><p>​ <br>
<img loading="lazy" src="./20210514/hist_output_10_0.png" alt="png"  />

​</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 左上角坐标(0,0)，右下角下标(100,100)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 裁剪出 100*100 的区域</span>
</span></span><span style="display:flex;"><span>box <span style="color:#f92672">=</span> (<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span>region <span style="color:#f92672">=</span> im<span style="color:#f92672">.</span>crop(box)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 保存</span>
</span></span><span style="display:flex;"><span>region<span style="color:#f92672">.</span>save(<span style="color:#e6db74">&#39;roi.tif&#39;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 读取保存的 RoI</span>
</span></span><span style="display:flex;"><span>roi_im <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>open(<span style="color:#e6db74">&#39;./roi.tif&#39;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>roi_im<span style="color:#f92672">.</span>size
</span></span></code></pre></div><pre><code>(100, 100)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 不转换为灰度图片</span>
</span></span><span style="display:flex;"><span>im <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>open(<span style="color:#e6db74">&#39;axon01.tif&#39;</span>)
</span></span><span style="display:flex;"><span>im2array <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(im)
</span></span><span style="display:flex;"><span>im2array <span style="color:#f92672">=</span> im2array<span style="color:#f92672">.</span>flatten()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 统计像素值对应的像素个数</span>
</span></span><span style="display:flex;"><span>hist <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> (np<span style="color:#f92672">.</span>max(im2array)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, len(im2array)):
</span></span><span style="display:flex;"><span>    hist[im2array[i]] <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 绘制直方图</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">25</span>,<span style="color:#ae81ff">10</span>))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, np<span style="color:#f92672">.</span>max(im2array)):
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>bar(i, hist[i], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;r&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>grid(color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">0.1</span>)
</span></span></code></pre></div><p>​ <br>
<img loading="lazy" src="./20210514/hist_output_17_0.png" alt="png"  />

​</p>
<h2 id="使用-pillow-库绘制直方图">使用 Pillow 库绘制直方图<a hidden class="anchor" aria-hidden="true" href="#使用-pillow-库绘制直方图">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 求[0,255]像素频率</span>
</span></span><span style="display:flex;"><span>histogram <span style="color:#f92672">=</span> im<span style="color:#f92672">.</span>histogram()
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 这个分布符合直觉，大部分都是黑色</span>
</span></span><span style="display:flex;"><span>print(histogram)
</span></span></code></pre></div><pre><code>[3341, 138883, 751, 581, 499, 536, 582, 11, 645, 687, 717, 774, 800, 895, 946, 1071, 1367, 6, 1131, 1178, 1212, 1256, 1384, 1407, 1491, 1548, 1649, 5, 1726, 1760, 1855, 1869, 1982, 2007, 1993, 2027, 2069, 3, 2161, 2230, 2316, 2194, 2337, 2293, 2304, 2316, 2427, 6, 2474, 2341, 2359, 2380, 2380, 2301, 3120, 2300, 2175, 1, 2208, 2151, 2059, 2089, 2068, 1994, 1891, 1957, 1775, 3, 1753, 1725, 1676, 1718, 1527, 1527, 1490, 1361, 1281, 4, 1718, 1254, 1101, 1092, 1027, 974, 894, 896, 796, 3, 820, 727, 720, 650, 670, 585, 548, 498, 487, 1, 442, 400, 387, 335, 339, 345, 293, 279, 220, 4, 235, 224, 227, 189, 196, 173, 165, 244, 147, 3, 118, 113, 109, 109, 109, 110, 98, 74, 76, 2, 75, 77, 74, 69, 73, 57, 75, 67, 56, 2, 57, 44, 63, 57, 47, 36, 38, 35, 40, 1, 43, 28, 41, 29, 34, 34, 26, 33, 21, 1, 35, 32, 8, 22, 38, 19, 34, 32, 33, 0, 20, 22, 10, 26, 16, 19, 11, 21, 12, 1, 23, 12, 29, 20, 10, 13, 7, 11, 19, 1, 18, 14, 6, 18, 13, 13, 9, 14, 10, 2, 10, 11, 13, 12, 10, 9, 11, 14, 4, 1, 15, 13, 12, 15, 10, 3, 11, 9, 9, 4, 14, 14, 15, 17, 16, 15, 19, 18, 16, 15, 19, 25, 34, 35, 32, 9, 45, 49, 54, 47, 65, 85, 101, 108, 92, 5, 102, 149, 141, 157, 185, 201, 207, 222, 275, 6, 318, 297]
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 最大值 138883 表示有 138883 个值为 1的像素</span>
</span></span><span style="display:flex;"><span>max(histogram)
</span></span></code></pre></div><pre><code>138883
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i, value <span style="color:#f92672">in</span> enumerate(im<span style="color:#f92672">.</span>histogram()):
</span></span><span style="display:flex;"><span>    print(i, value)
</span></span></code></pre></div><pre><code>0 3341
1 138883
2 751
3 581
4 499
5 536
6 582
7 11
8 645
9 687
10 717
11 774
12 800
13 895
14 946
15 1071
16 1367
17 6
18 1131
19 1178
20 1212
21 1256
22 1384
23 1407
24 1491
25 1548
26 1649
27 5
28 1726
29 1760
30 1855
31 1869
32 1982
33 2007
34 1993
35 2027
36 2069
37 3
38 2161
39 2230
40 2316
41 2194
42 2337
43 2293
44 2304
45 2316
46 2427
47 6
48 2474
49 2341
50 2359
51 2380
52 2380
53 2301
54 3120
55 2300
56 2175
57 1
58 2208
59 2151
60 2059
61 2089
62 2068
63 1994
64 1891
65 1957
66 1775
67 3
68 1753
69 1725
70 1676
71 1718
72 1527
73 1527
74 1490
75 1361
76 1281
77 4
78 1718
79 1254
80 1101
81 1092
82 1027
83 974
84 894
85 896
86 796
87 3
88 820
89 727
90 720
91 650
92 670
93 585
94 548
95 498
96 487
97 1
98 442
99 400
100 387
101 335
102 339
103 345
104 293
105 279
106 220
107 4
108 235
109 224
110 227
111 189
112 196
113 173
114 165
115 244
116 147
117 3
118 118
119 113
120 109
121 109
122 109
123 110
124 98
125 74
126 76
127 2
128 75
129 77
130 74
131 69
132 73
133 57
134 75
135 67
136 56
137 2
138 57
139 44
140 63
141 57
142 47
143 36
144 38
145 35
146 40
147 1
148 43
149 28
150 41
151 29
152 34
153 34
154 26
155 33
156 21
157 1
158 35
159 32
160 8
161 22
162 38
163 19
164 34
165 32
166 33
167 0
168 20
169 22
170 10
171 26
172 16
173 19
174 11
175 21
176 12
177 1
178 23
179 12
180 29
181 20
182 10
183 13
184 7
185 11
186 19
187 1
188 18
189 14
190 6
191 18
192 13
193 13
194 9
195 14
196 10
197 2
198 10
199 11
200 13
201 12
202 10
203 9
204 11
205 14
206 4
207 1
208 15
209 13
210 12
211 15
212 10
213 3
214 11
215 9
216 9
217 4
218 14
219 14
220 15
221 17
222 16
223 15
224 19
225 18
226 16
227 15
228 19
229 25
230 34
231 35
232 32
233 9
234 45
235 49
236 54
237 47
238 65
239 85
240 101
241 108
242 92
243 5
244 102
245 149
246 141
247 157
248 185
249 201
250 207
251 222
252 275
253 6
254 318
255 297
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 像素总数 283968 = 204*1392</span>
</span></span><span style="display:flex;"><span>np<span style="color:#f92672">.</span>sum(histogram)
</span></span></code></pre></div><pre><code>283968
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 灰度级在 [0,255]</span>
</span></span><span style="display:flex;"><span>len(histogram)
</span></span></code></pre></div><pre><code>256
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">50</span>,<span style="color:#ae81ff">30</span>))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">256</span>):
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>bar(i, histogram[i], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;r&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>grid(color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">0.1</span>)
</span></span></code></pre></div><p>​ <br>
<img loading="lazy" src="./20210514/hist_output_25_0.png" alt="png"  />

​</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"></code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://landodo.github.io/tags/python/">Python</a></li>
      <li><a href="http://landodo.github.io/tags/pillow/">Pillow</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://landodo.github.io/posts/20210516-retinal-vesse-segmentation/">
    <span class="title">« Prev Page</span>
    <br>
    <span>视网膜血管分割 Retinal vessel segmentation</span>
  </a>
  <a class="next" href="http://landodo.github.io/posts/20210514-mnist/">
    <span class="title">Next Page »</span>
    <br>
    <span>MNIST (Mixed National Institute of Standards and Technology database)</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>Landon</span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
