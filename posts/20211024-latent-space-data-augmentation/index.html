<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                {left: "$$", right: "$$", display: true},
                {left: "$", right: "$", display: false}
            ]
        });
    });
</script>
<meta name="robots" content="index, follow">
<title>20211024 Latent Space Data Augmentation | Landodo&#39;s NoteBook</title>
<meta name="keywords" content="æ•°æ®å¢å¼º, è®ºæ–‡é˜…è¯», åŒ»å­¦å›¾åƒåˆ†å‰²" />
<meta name="description" content="Cooperative Training and Latent Space Data Augmentation for Robust Medical Image Segmentation è®ºæ–‡é¢˜ç›®ï¼šååŒè®­ç»ƒå’Œéšç©ºé—´æ•°æ®å¢å¼ºçš„é²æ£’æ€§åŒ»å­¦å›¾åƒåˆ†å‰² https://arxiv.org/abs/2107.01079 ä¼šè®®ï¼šMICCAI 2021 ä½œè€…ï¼šChen CHEN é™ˆæ™¨ https://sites.google.com/view/morningchen-site/home Research Assistant/PhD ä¼¦æ•¦å¸å›½ç†å·¥å­¦">
<meta name="author" content="">
<link rel="canonical" href="http://landodo.github.io/posts/20211024-latent-space-data-augmentation/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css" integrity="sha256-yIlj/i15RiAA/Q&#43;xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js" integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="http://landodo.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://landodo.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://landodo.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://landodo.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="http://landodo.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="20211024 Latent Space Data Augmentation" />
<meta property="og:description" content="Cooperative Training and Latent Space Data Augmentation for Robust Medical Image Segmentation è®ºæ–‡é¢˜ç›®ï¼šååŒè®­ç»ƒå’Œéšç©ºé—´æ•°æ®å¢å¼ºçš„é²æ£’æ€§åŒ»å­¦å›¾åƒåˆ†å‰² https://arxiv.org/abs/2107.01079 ä¼šè®®ï¼šMICCAI 2021 ä½œè€…ï¼šChen CHEN é™ˆæ™¨ https://sites.google.com/view/morningchen-site/home Research Assistant/PhD ä¼¦æ•¦å¸å›½ç†å·¥å­¦" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://landodo.github.io/posts/20211024-latent-space-data-augmentation/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-10-24T09:08:38&#43;08:00" />
<meta property="article:modified_time" content="2021-10-24T09:08:38&#43;08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="20211024 Latent Space Data Augmentation"/>
<meta name="twitter:description" content="Cooperative Training and Latent Space Data Augmentation for Robust Medical Image Segmentation è®ºæ–‡é¢˜ç›®ï¼šååŒè®­ç»ƒå’Œéšç©ºé—´æ•°æ®å¢å¼ºçš„é²æ£’æ€§åŒ»å­¦å›¾åƒåˆ†å‰² https://arxiv.org/abs/2107.01079 ä¼šè®®ï¼šMICCAI 2021 ä½œè€…ï¼šChen CHEN é™ˆæ™¨ https://sites.google.com/view/morningchen-site/home Research Assistant/PhD ä¼¦æ•¦å¸å›½ç†å·¥å­¦"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://landodo.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "20211024 Latent Space Data Augmentation",
      "item": "http://landodo.github.io/posts/20211024-latent-space-data-augmentation/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "20211024 Latent Space Data Augmentation",
  "name": "20211024 Latent Space Data Augmentation",
  "description": "Cooperative Training and Latent Space Data Augmentation for Robust Medical Image Segmentation è®ºæ–‡é¢˜ç›®ï¼šååŒè®­ç»ƒå’Œéšç©ºé—´æ•°æ®å¢å¼ºçš„é²æ£’æ€§åŒ»å­¦å›¾åƒåˆ†å‰² https://arxiv.org/abs/2107.01079 ä¼šè®®ï¼šMICCAI 2021 ä½œè€…ï¼šChen CHEN é™ˆæ™¨ https://sites.google.com/view/morningchen-site/home Research Assistant/PhD ä¼¦æ•¦å¸å›½ç†å·¥å­¦",
  "keywords": [
    "æ•°æ®å¢å¼º", "è®ºæ–‡é˜…è¯»", "åŒ»å­¦å›¾åƒåˆ†å‰²"
  ],
  "articleBody": "Cooperative Training and Latent Space Data Augmentation for Robust Medical Image Segmentation\nè®ºæ–‡é¢˜ç›®ï¼šååŒè®­ç»ƒå’Œéšç©ºé—´æ•°æ®å¢å¼ºçš„é²æ£’æ€§åŒ»å­¦å›¾åƒåˆ†å‰²\n https://arxiv.org/abs/2107.01079  ä¼šè®®ï¼šMICCAI 2021\nä½œè€…ï¼šChen CHEN é™ˆæ™¨\n  https://sites.google.com/view/morningchen-site/home\n  Research Assistant/PhD ä¼¦æ•¦å¸å›½ç†å·¥å­¦é™¢ Research Assistant/PhD\n  æœ¬ç§‘å“ˆå·¥å¤§ ç‰©è”ç½‘å·¥ç¨‹\n  ä»£ç ï¼šhttps://github.com/cherise215/Cooperative_Training_and_Latent_Space_Data_Augmentation\nAbstract åŸºäºæ·±åº¦å­¦ä¹ çš„åˆ†å‰²æ–¹æ³•åœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­å®¹æ˜“å—åˆ°ä¸å¯é¢„è§çš„æ•°æ®åˆ†å¸ƒï¼ˆunforeseen data distributionï¼‰å˜åŒ–çš„å½±å“ï¼Œä¾‹å¦‚ï¼Œä¸åŒæ‰«æä»ªå¼•èµ·çš„å›¾åƒå¤–è§‚æˆ–å¯¹æ¯”åº¦çš„å˜åŒ–ï¼Œä¼ªå½±ç­‰ã€‚æœ¬ç¯‡è®ºæ–‡æå‡ºäº†ä¸€ä¸ªç”¨äºå›¾åƒåˆ†å‰²æ¨¡å‹çš„ååŒè®­ç»ƒæ¡†æ¶å’Œä¸€ä¸ªç”¨äºç”Ÿæˆå›°éš¾æ ·æœ¬çš„éšç©ºé—´æ•°æ®å¢å¼ºæ–¹æ³•ï¼Œæå‡äº†æ¨¡å‹çš„æ³›åŒ–æ€§å’Œæœ‰é™æ•°æ®çš„ç¨³å¥æ€§ã€‚\n ååŒè®­ç»ƒæ¡†æ¶ç”± fast-thinking network(FTN) å’Œ slow-thinking network(STN) æ„æˆã€‚FTN å­¦ä¹ è§£è€¦çš„å›¾åƒç‰¹å¾å’Œå½¢çŠ¶ç‰¹å¾ï¼Œç”¨äºå›¾åƒé‡å»ºå’Œåˆ†å‰²ä»»åŠ¡ï¼› STN å­¦ä¹ å½¢çŠ¶å…ˆéªŒï¼Œç”¨äºåˆ†å‰²æ ¡æ­£å’Œç»†åŒ–ã€‚ éšç©ºé—´æ•°æ®å¢å¼ºï¼ˆlatent space DAï¼‰æ˜¯é€šè¿‡åœ¨é€šé“å’Œç©ºé—´ä¸Šé®ç›–è§£è€¦çš„éšç©ºé—´ï¼Œä¸ºè®­ç»ƒç”Ÿæˆå…·æœ‰æŒ‘æˆ˜æ€§çš„æ ·æœ¬ã€‚  åœ¨å…¬å…±å¿ƒè„æˆåƒæ•°æ®é›†è¿›è¡Œäº†å¹¿æ³›çš„å®éªŒï¼Œè¯å®äº†åˆ†å‰²æ€§èƒ½çš„æé«˜ï¼Œä»¥åŠæé«˜äº†å¯¹å„ç§ä¸å¯é¢„è§çš„æˆåƒä¼ªå½±çš„ç¨³å¥æ€§ã€‚ä¸æ ‡å‡†çš„è®­ç»ƒæ–¹æ³•ç›¸æ¯”ï¼Œå…·æœ‰éšç©ºé—´æ•°æ®å¢å¼ºçš„ååŒè®­ç»ƒåœ¨å¹³å‡ Dice æé«˜äº†15%ã€‚\n1 Introduction å°†åŸºäºæ·±åº¦å­¦ä¹ çš„æ–¹æ³•éƒ¨ç½²åˆ°å®é™…åº”ç”¨ä¸­çš„ä¸€ä¸ªä¸»è¦éšœç¢æ˜¯ä¸´åºŠéƒ¨ç½²è¿‡ç¨‹ä¸­çš„åŸŸè½¬ç§»ï¼ˆdomain shiftï¼‰ï¼Œå…¶ä¸­åŒ…æ‹¬ä¸åŒåŒ»ç–—ä¸­å¿ƒå’Œæ‰«æä»ªçš„å›¾åƒå¤–è§‚å’Œå¯¹æ¯”åº¦çš„å˜åŒ–ï¼Œä»¥åŠå„ç§æˆåƒä¼ªå½±ã€‚åœ¨ Multi-domain datasets ä¸Šå­¦ä¹ åŸŸä¸å˜çš„ç‰¹å¾è¿›è¡Œåˆ†å‰²å¯ä»¥è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œä½†æ˜¯ Multi-domain æ•°æ®çš„è·å–æˆæœ¬è¾ƒé«˜ï¼Œå› æ­¤ä» single-domain å’Œæœ‰é™çš„æ•°æ®ä¸­å­¦ä¹ ç¨³å¥çš„ç½‘ç»œï¼Œå¯¹åŒ»å­¦å½±åƒç ”ç©¶å…·æœ‰é‡è¦çš„å®ç”¨ä»·å€¼ã€‚\næœ¬ç¯‡è®ºæ–‡æå‡ºäº†ä¸€ä¸ªæ–°çš„ååŒè®­ç»ƒæ¡†æ¶ï¼Œç”¨äºä» single-domain æ•°æ®ä¸­å­¦ä¹ åˆ°ä¸€ä¸ªç¨³å¥çš„åˆ†å‰²ç½‘ç»œã€‚ä¸»è¦è´¡çŒ®å¯ä»¥æ€»ç»“å¦‚ä¸‹ï¼š\nï¼ˆ1ï¼‰è®¾è®¡äº†ä¸€ä¸ªç”±ä¸¤ä¸ªç½‘ç»œç»„æˆçš„ååŒè®­ç»ƒæ¡†æ¶è¿™ä¸ªæ¡†æ¶å¯å‘è‡ªäººç±»è¡Œä¸ºä¸­çš„åŒç³»ç»Ÿæ¨¡å‹ï¼šå¿«é€Ÿæ€ç»´ç³»ç»Ÿåšå‡ºç›´è§‰åˆ¤æ–­ï¼Œè€Œæ…¢é€Ÿæ€ç»´ç³»ç»Ÿåˆ™é€šè¿‡é€»è¾‘æ¨ç†è¿›è¡Œçº æ­£ã€‚\nå¯¹åº”åˆ°æ¡†æ¶ä¸­ï¼Œfast-thinking network (FTN) æ—¨åœ¨ç†è§£å›¾åƒçš„ä¸Šä¸‹æ–‡ï¼Œå¹¶æå–ä¸ä»»åŠ¡ç›¸å…³çš„å›¾åƒå’Œå½¢çŠ¶ç‰¹å¾è¿›è¡Œåˆå§‹åˆ†å‰²ï¼›slow-thinking network (STN) æ ¹æ®å­¦ä¹ åˆ°çš„å½¢çŠ¶å…ˆéªŒæ¥å®Œå–„åˆå§‹åˆ†å‰²ã€‚\nï¼ˆ2ï¼‰æå‡ºäº†ä¸€ç§éšç©ºé—´æ•°æ®å¢å¼ºæ–¹æ³• latent space data augmentation (DA) methodéšæœºå’Œæœ‰é’ˆå¯¹æ€§çš„æ–¹å¼å¯¹ä» FTN ä¸­å­¦ä¹ åˆ°çš„éšç¼–ç ï¼ˆlatent codeï¼‰è¿›è¡Œé€šé“å’Œç©ºé—´çš„é®ç›–ï¼ˆå±è”½ï¼‰ï¼Œè¿™æ ·å°±ä¼šé‡å»ºå‡ºä¸€ç»„å¤šæ ·åŒ–çš„æŒ‘æˆ˜æ€§å›¾åƒå’Œå¯¹åº”çš„åˆ†å‰²å›¾ï¼Œä»¥åŠ å¼ºä¸¤ä¸ªç½‘ç»œçš„è®­ç»ƒã€‚\n2 Methodology single domain dataset $D_{tr} = {(x_i, y_i)}^{n}_{i=1}$\nimage $x_i \\in \\mathbb{R}^{H \\times W}$\none-hot encoded C-class label maps $y_i \\in {0, 1}^{H \\times W \\times C}$ ï¼ˆground truthï¼‰\n2.1 Framework ç»™å®šè¾“å…¥å›¾åƒ xï¼ŒFTN æå–ç‰¹å®šä»»åŠ¡çš„å½¢çŠ¶ç‰¹å¾ $z_s$ æ¥æ‰§è¡Œåˆ†å‰²ä»»åŠ¡ï¼Œæå–å›¾åƒä¸Šä¸‹æ–‡ç‰¹å¾ $z_i$ æ¥æ‰§è¡Œå›¾åƒé‡å»ºä»»åŠ¡ã€‚å…±äº« encoder $E_{\\theta}$ï¼Œç‰¹å¾è§£è€¦å™¨ $\\mathcal{H}$ï¼Œ ä¸¤ä¸ªç‰¹å®šä»»åŠ¡çš„è§£ç å™¨ $D_{\\phi_s}$ã€$D_{\\phi_i}$ ç”¨äºå›¾åƒåˆ†å‰²å’Œé‡å»ºä»»åŠ¡ã€‚\nå¯¹ $z_i$ åº”ç”¨ç‰¹å¾è§£è€¦å™¨ $\\mathcal{H}$ï¼Œä½¿ä¸åˆ†å‰²ä»»åŠ¡æ— å…³çš„ä¿¡æ¯ï¼ˆå¦‚å›¾åƒçº¹ç†ä¿¡æ¯ã€äº®åº¦ï¼‰åœ¨ $z_s$ ä¸­è¢«åœç”¨ï¼Œç¨€ç–çš„ $z_s$ æœ‰ç›Šäºæ¨¡å‹çš„ç¨³å¥æ€§ã€‚\n$\\mathcal{H}$ ç”±ä¸¤ä¸ªå·ç§¯å±‚å †å ï¼Œåæ¥ ReLU æ¿€æ´»å‡½æ•°ã€‚å›¾åƒé‡å»ºéœ€è¦ä½å±‚æ¬¡çš„ä¿¡æ¯ï¼Œè€Œå›¾åƒåˆ†å‰²åˆ™ä¾èµ–äºæ›´é›†ä¸­çš„é«˜å±‚æ¬¡ä¿¡æ¯ã€‚å¼•å…¥ $\\mathcal{H}$ æ˜ç¡®åœ°å®šä¹‰äº†ä¸€ä¸ªåˆ†å±‚çš„ç‰¹å¾ç»“æ„ï¼Œä»¥æé«˜æ¨¡å‹çš„é€šç”¨æ€§ï¼›\nSTN æ˜¯ä¸€ä¸ªå»å™ªè‡ªåŠ¨ç¼–ç å™¨ç½‘ç»œ $C_{\\psi}$ï¼Œå­¦ä¹ å½¢çŠ¶å…ˆéªŒæ¥çº æ­£ FTN é¢„æµ‹çš„åˆ†å‰²ã€‚åœ¨æ¨ç†æ—¶ï¼ŒFTN è¿›è¡Œå¯¹ç»™å®šçš„å›¾åƒ x è¿›è¡Œå¿«é€Ÿåˆ†å‰²ï¼š$p = D_{\\phi_s}(\\mathcal{H}(E_{\\theta}(x)))$ï¼›STN å®Œå–„åˆ†å‰²ç»“æœï¼š$pâ€™ = C_{\\psi}(p)$ã€‚\n2.2 Standard Training ç”¨ç›‘ç£çš„å¤šä»»åŠ¡æŸå¤±å‡½æ•°è”åˆè®­ç»ƒä¸‰ä¸ªç¼–ç å™¨-è§£ç å™¨å¯¹ï¼ŒæŸå¤±åŒ…å«ï¼šå›¾åƒé‡å»º $L_{rec}$ã€å›¾åƒåˆ†å‰² $L_{seg}$ã€å½¢çŠ¶æ ¡æ­£ $L_{shp}$ã€‚\n $L_{rec}$ æ˜¯ Mean Squared Error(MSE) $L_{seg}, L_{shp}$ æ˜¯ cross-entropy function $yâ€™ = C_{\\psi}(y)$  2.3 Latent Space Data Augmentation for Hard Example Generation ä¸ºäº†ç¼“è§£è¿‡æ‹Ÿåˆï¼Œæå‡ºäº† latent space DA methodï¼Œä½¿å¾— FTN å¯ä»¥è‡ªåŠ¨æ„å»ºå…·æœ‰æŒ‘æˆ˜æ€§çš„æ ·æœ¬ã€‚\næ©ç ç”Ÿæˆå™¨ $\\mathcal{G}$ åœ¨ latent code $z$ ä¸Šäº§ç”Ÿä¸€ä¸ªæ©ç  mï¼Œä¹‹å $\\hat{z} = z \\cdot m$ è¾“å…¥åˆ°è§£ç å™¨é‡æ„å‡ºè¢«ç ´åçš„å›¾åƒ $\\hat{x} = D_{\\phi_i}(\\hat{z_i})$ å’Œå…¶å¯¹åº”çš„åˆ†å‰²å›¾ $\\hat{p} = D_{\\phi_s}(\\hat{z_s})$ã€‚è¿™å°±æ˜¯ latent code masking æ•°æ®å¢å¼ºæ–¹æ³•ã€‚\né€šè¿‡åŠ¨æ€å±è”½ latent codeï¼Œæ‰€æå‡ºçš„æ–¹æ³•å¯ä»¥ç”Ÿæˆå…·æœ‰å¹¿æ³›å¤šæ ·æ€§çš„å›¾åƒå¤–è§‚å’Œåˆ†å‰²çš„æ ·æœ¬ã€‚å¦‚ä¸‹ä»‹ç»å‡ ç§ latent-code masking æ–¹æ¡ˆï¼š\nï¼ˆ1ï¼‰Random Masking with Dropout\nlatent-code çš„æ•´ä¸ªé€šé“åœ¨è®­ç»ƒæ—¶ä»¥ p çš„æ¦‚ç‡è¢«æ©ç›–ä¸ºå…¨é›¶ã€‚\nè¢«é®ç›–åç¬¬ i ä¸ªé€šé“çš„ç»“æœä¸ºï¼š$\\hat{z}^{(i)} = z^{(i)} \\cdot m^{(i)}$ã€‚$z \\in \\mathbb{R}^{c \\times h \\times w}$ã€‚\nï¼ˆ2ï¼‰Target Masking\næå‡ºäº†æœ‰é’ˆå¯¹æ€§çš„ latent-code masking æ–¹æ¡ˆï¼Œè¯¥æ–¹æ¡ˆä»¥æ¢¯åº¦ä¸ºçº¿ç´¢æ¥è¯†åˆ«è¦æ©è”½çš„â€œçªå‡ºâ€ç‰¹å¾ã€‚ é‡‡å–å›¾åƒé‡å»ºæŸå¤±å’Œå›¾åƒåˆ†å‰²æŸå¤±ï¼Œåˆ†åˆ«è®¡ç®— $z_i$ å’Œ $z_s$ çš„æ¢¯åº¦ $g_{z_i}$å’Œ $g_{z_s}$ã€‚\nå¯¹æ¢¯åº¦å€¼è¿›è¡Œæ’åºï¼Œå¯ä»¥ç¡®å®šå‡ºé‚£äº›æœ€å…·é¢„æµ‹æ€§çš„å…ƒç´ ã€‚ä½œè€…å‡è®¾ï¼Œå¯¹æŸå¤±å‡½æ•°ååº”è¾ƒé«˜çš„å…ƒç´ æ˜¯å¯¼è‡´åœ¨ä¸å¯é¢„è§çš„åŸŸè½¬ç§»ä¸‹æ€§èƒ½ä¸‹é™çš„ä¸»è¦åŸå› ã€‚å› æ­¤ï¼Œå¯¹è¿™ç§å…ƒç´ è¿›è¡Œæœ‰é’ˆå¯¹æ€§çš„é®è”½ï¼Œä»¥æ¨¡æ‹Ÿæ•°æ®åˆ†å¸ƒçš„è½¬ç§»ï¼ˆdata distribution shiftsï¼‰ã€‚å¯ä»¥åœ¨é€šé“ç»´åº¦å’Œç©ºé—´ç»´åº¦é®è”½ latent-code $z$ çš„ç‰¹å¾ã€‚\n $z^{ch}_p, z^{sp}_p$ é˜ˆå€¼ a æ˜¯ (0, 0.5) ä¹‹é—´éšæœºæŠ½å–çš„é€€ç«ç³»æ•°ï¼Œåˆ›å»º soft masksï¼›  Channel-wise masked code at i-th channelï¼š\n$\\hat{z}^{(i)} = z^{(i)} \\cdot m^{(i)}$\nSpatial-wise masked code at (j, k) positionï¼š\n$\\hat{z}^{(j, k)} = z^{(j, k)} \\cdot m^{(j, k)}$\n2.4 ååŒè®­ç»ƒ è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œéšæœºåœ°å°†ä¸Šé¢ä»‹ç»çš„ä¸‰ç§ mask generator åº”ç”¨äº $z_i, z_s$ï¼Œè¿™ä¸ªæ“ä½œç”Ÿæˆä¸€ç»„ä¸°å¯Œçš„å¢å¼ºå›¾åƒ $\\hat{x}$ å’Œåˆ†å‰²å›¾ $\\hat{p}$ã€‚è¿™å°±å¾—åˆ° 3 example pairs ç”¨äºè®­ç»ƒï¼š\n corrupted images-clean images $(\\hat{x}, x)$ corrupted images-GT $(\\hat{x}, y)$ corrupted GT-GT $(\\hat{p}, y)$  åˆä½œè®­ç»ƒçš„æœ€ç»ˆæŸå¤±å®šä¹‰ä¸ºç®€å•ä¾‹å­å’Œå›°éš¾ä¾‹å­ä¸Šçš„æŸå¤±çš„ç»„åˆã€‚\n3 Experiments and Results åº”ç”¨ä¸å¿ƒè„å›¾åƒåˆ†å‰²ä»»åŠ¡ï¼Œä» MR å›¾åƒä¸­åˆ†å‰²å‡ºå·¦å¿ƒå®¤è…”ã€å·¦å¿ƒå®¤å¿ƒè‚Œå’Œå³å¿ƒå®¤ã€‚\næ•°æ®é›†ï¼š\n  ACDCï¼šè®­ç»ƒã€intra-domain æµ‹è¯•\n  M\u0026Msï¼šcross-domain æµ‹è¯•\n  ACDC-C (corrupted ACDC)ï¼šè¯„ä¼°æ•°æ®å¢å¼ºæ–¹æ³•çš„é²æ£’æ€§\n  ï¼ˆ1ï¼‰å®éªŒ 1ï¼šStandard Training vs Cooperative Training\n ä¸¤ç§æ–¹æ³•åœ¨åŸŸå†…æµ‹è¯•é›†ä¸Šå–å¾—äº†ç›¸è¿‘çš„æ€§èƒ½ï¼› åŒç½‘ç»œï¼ˆFTN+STNï¼‰çš„ååŒè®­ç»ƒåœ¨åŸŸå¤–æµ‹è¯•é›†ä¸Šå–å¾—äº†æ›´é«˜çš„æ€§èƒ½ï¼› éšç©ºé—´æ•°æ®å¢å¼ºæ–¹æ³•æ•°æ®ä¸Šï¼ŒååŒè®­ç»ƒä¹Ÿè¡¨ç°å‡ºäº†å…¶ä¼˜è¶Šæ€§ã€‚  ï¼ˆ2ï¼‰å®éªŒ 2: Latent Space DA vs Image Space DA\nTable 1 ä¸­ AdvBias åœ¨ M\u0026Ms æ•°æ®é›†å’Œ RandBias ä¸Šå–å¾—äº†æœ€å¥½çš„æ€§èƒ½ï¼Œä½†è¿™ç§æ–¹æ³•æœ‰ä¸€ä¸ªå‰¯ä½œç”¨ï¼Œä½¿å…¶å¯¹å°–å³°ä¼ªå½±æ›´åŠ æ•æ„Ÿï¼ˆDice å¾—åˆ† 0.4901 vs 0.3840ï¼‰ã€‚latent-space DA åœ¨å…­ä¸ªæ•°æ®é›†ä¸Šå–å¾—äº†æœ€é«˜çš„å¹³å‡æ€§èƒ½ã€‚\nå›¾ 3. æœ¬ç¯‡è®ºæ–‡çš„æ–¹æ³•ä¸ä»…å¯ä»¥ç”Ÿæˆæ‰°åŠ¨çš„å›¾åƒï¼Œè¿˜å¯ä»¥ç”Ÿæˆä¸ç¡®å®šæ€§å¢åŠ çš„çœŸå®çš„æŸåçš„åˆ†å‰²ã€‚\nï¼ˆ3ï¼‰å®éªŒ 3ï¼šAblation Study\n(a) the proposed targeted masking; b) latent code decoupler H; c) cooperative training.\n ç¦ç”¨ $\\mathcal{G}{ch}ã€\\mathcal{G}{sp}$ åï¼Œå¹³å‡ Dice å¾—åˆ†ä» 0.6901 é™è‡³ 0.6584ï¼› å›¾åƒé‡å»ºéœ€è¦ä½å±‚æ¬¡çš„ä¿¡æ¯ï¼Œè€Œå›¾åƒåˆ†å‰²åˆ™ä¾èµ–äºæ›´é›†ä¸­çš„é«˜å±‚æ¬¡ä¿¡æ¯ã€‚å¼•å…¥ Hæ˜ç¡®åœ°å®šä¹‰äº†ä¸€ä¸ªåˆ†å±‚çš„ç‰¹å¾ç»“æ„ï¼Œä»¥æé«˜æ¨¡å‹çš„é€šç”¨æ€§ï¼› çªå‡ºäº†åˆä½œè®­ç»ƒç­–ç•¥åŠ å¼ºåŸºäºå­¦ä¹ çš„å½¢çŠ¶ç»†åŒ–å’Œä¿®æ­£ï¼›  4 Conclusion  æå‡ºäº†ä¸€ä¸ªæ–°çš„ååŒè®­ç»ƒæ¡†æ¶ï¼Œä»¥åŠä¸€ä¸ª latent space masking-based çš„æ•°æ®å¢å¼ºæ–¹æ³•ï¼› å®éªŒéªŒè¯äº†æ¨¡å‹çš„é€šç”¨æ€§å’Œå¯¹ä¸å¯é¢„è§çš„é¢†åŸŸè½¬å˜çš„é²æ£’æ€§ï¼› latent-space DA æ–¹æ³•åªéœ€è¦å¾ˆå°‘çš„ä»£ä»·ï¼› ç›®å‰åªåœ¨å¿ƒè„å›¾åƒåˆ†å‰²ä¸Šå±•ç¤ºäº†å…¶æ€§èƒ½ï¼Œè¯¥é€šç”¨æ¡†æ¶æœ‰å¯èƒ½æ‰©å±•åˆ°å¹¿æ³›çš„æ•°æ®é©±åŠ¨çš„åº”ç”¨ã€‚  ",
  "wordCount" : "2879",
  "inLanguage": "en",
  "datePublished": "2021-10-24T09:08:38+08:00",
  "dateModified": "2021-10-24T09:08:38+08:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://landodo.github.io/posts/20211024-latent-space-data-augmentation/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Landodo's NoteBook",
    "logo": {
      "@type": "ImageObject",
      "url": "http://landodo.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://landodo.github.io/" accesskey="h" title="Landodo&#39;s NoteBook (Alt + H)">Landodo&#39;s NoteBook</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="http://landodo.github.io/search" title="ğŸ”Search (Alt &#43; /)" accesskey=/>
                    <span>ğŸ”Search</span>
                </a>
            </li>
            <li>
                <a href="http://landodo.github.io/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="http://landodo.github.io/archives/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="http://landodo.github.io/tags" title="Tag">
                    <span>Tag</span>
                </a>
            </li>
            <li>
                <a href="http://landodo.github.io/about" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="http://landodo.github.io/cs-zoo" title="CS ZOO">
                    <span>CS ZOO</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://landodo.github.io/">Home</a>&nbsp;Â»&nbsp;<a href="http://landodo.github.io/posts/">Posts</a></div>
    <h1 class="post-title">
      20211024 Latent Space Data Augmentation
    </h1>
    <div class="post-meta"><span title='2021-10-24 09:08:38 +0800 CST'>October 24, 2021</span>&nbsp;Â·&nbsp;6 min&nbsp;Â·&nbsp;2879 words

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#abstract" aria-label="Abstract">Abstract</a></li>
                <li>
                    <a href="#1-introduction" aria-label="1 Introduction">1 Introduction</a></li>
                <li>
                    <a href="#2-methodology" aria-label="2 Methodology">2 Methodology</a><ul>
                        
                <li>
                    <a href="#21-framework" aria-label="2.1 Framework">2.1 Framework</a></li>
                <li>
                    <a href="#22-standard-training" aria-label="2.2 Standard Training">2.2 Standard Training</a></li>
                <li>
                    <a href="#23-latent-space-data-augmentation-for-hard-example-generation" aria-label="2.3 Latent Space Data Augmentation for Hard Example Generation">2.3 Latent Space Data Augmentation for Hard Example Generation</a></li>
                <li>
                    <a href="#24-%e5%8d%8f%e5%90%8c%e8%ae%ad%e7%bb%83" aria-label="2.4 ååŒè®­ç»ƒ">2.4 ååŒè®­ç»ƒ</a></li></ul>
                </li>
                <li>
                    <a href="#3-experiments-and-results" aria-label="3 Experiments and Results">3 Experiments and Results</a></li>
                <li>
                    <a href="#4-conclusion" aria-label="4 Conclusion">4 Conclusion</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>Cooperative Training and Latent Space Data Augmentation for Robust Medical Image Segmentation</p>
<p><strong>è®ºæ–‡é¢˜ç›®</strong>ï¼šååŒè®­ç»ƒå’Œéšç©ºé—´æ•°æ®å¢å¼ºçš„é²æ£’æ€§åŒ»å­¦å›¾åƒåˆ†å‰²</p>
<ul>
<li><a href="https://arxiv.org/abs/2107.01079">https://arxiv.org/abs/2107.01079</a></li>
</ul>
<p><strong>ä¼šè®®</strong>ï¼šMICCAI 2021</p>
<p><strong>ä½œè€…</strong>ï¼šChen CHEN é™ˆæ™¨</p>
<ul>
<li>
<p><a href="https://sites.google.com/view/morningchen-site/home">https://sites.google.com/view/morningchen-site/home</a></p>
</li>
<li>
<p>Research Assistant/PhD ä¼¦æ•¦å¸å›½ç†å·¥å­¦é™¢ Research Assistant/PhD</p>
</li>
<li>
<p>æœ¬ç§‘å“ˆå·¥å¤§ ç‰©è”ç½‘å·¥ç¨‹</p>
</li>
</ul>
<p><strong>ä»£ç </strong>ï¼šhttps://github.com/cherise215/Cooperative_Training_and_Latent_Space_Data_Augmentation</p>
<h2 id="abstract">Abstract<a hidden class="anchor" aria-hidden="true" href="#abstract">#</a></h2>
<p>åŸºäºæ·±åº¦å­¦ä¹ çš„åˆ†å‰²æ–¹æ³•åœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­å®¹æ˜“å—åˆ°ä¸å¯é¢„è§çš„æ•°æ®åˆ†å¸ƒï¼ˆunforeseen data distributionï¼‰å˜åŒ–çš„å½±å“ï¼Œä¾‹å¦‚ï¼Œä¸åŒæ‰«æä»ªå¼•èµ·çš„å›¾åƒå¤–è§‚æˆ–å¯¹æ¯”åº¦çš„å˜åŒ–ï¼Œä¼ªå½±ç­‰ã€‚æœ¬ç¯‡è®ºæ–‡æå‡ºäº†ä¸€ä¸ªç”¨äº<strong>å›¾åƒåˆ†å‰²æ¨¡å‹çš„ååŒè®­ç»ƒæ¡†æ¶</strong>å’Œä¸€ä¸ªç”¨äº<strong>ç”Ÿæˆå›°éš¾æ ·æœ¬çš„éšç©ºé—´æ•°æ®å¢å¼ºæ–¹æ³•</strong>ï¼Œæå‡äº†æ¨¡å‹çš„æ³›åŒ–æ€§å’Œæœ‰é™æ•°æ®çš„ç¨³å¥æ€§ã€‚</p>
<ul>
<li>ååŒè®­ç»ƒæ¡†æ¶ç”± fast-thinking network(FTN) å’Œ slow-thinking network(STN) æ„æˆã€‚FTN å­¦ä¹ è§£è€¦çš„å›¾åƒç‰¹å¾å’Œå½¢çŠ¶ç‰¹å¾ï¼Œç”¨äºå›¾åƒé‡å»ºå’Œåˆ†å‰²ä»»åŠ¡ï¼› STN å­¦ä¹ å½¢çŠ¶å…ˆéªŒï¼Œç”¨äºåˆ†å‰²æ ¡æ­£å’Œç»†åŒ–ã€‚</li>
<li>éšç©ºé—´æ•°æ®å¢å¼ºï¼ˆlatent space DAï¼‰æ˜¯é€šè¿‡åœ¨é€šé“å’Œç©ºé—´ä¸Šé®ç›–è§£è€¦çš„éšç©ºé—´ï¼Œä¸ºè®­ç»ƒç”Ÿæˆå…·æœ‰æŒ‘æˆ˜æ€§çš„æ ·æœ¬ã€‚</li>
</ul>
<p>åœ¨å…¬å…±å¿ƒè„æˆåƒæ•°æ®é›†è¿›è¡Œäº†å¹¿æ³›çš„å®éªŒï¼Œè¯å®äº†åˆ†å‰²æ€§èƒ½çš„æé«˜ï¼Œä»¥åŠæé«˜äº†å¯¹å„ç§ä¸å¯é¢„è§çš„æˆåƒä¼ªå½±çš„ç¨³å¥æ€§ã€‚ä¸æ ‡å‡†çš„è®­ç»ƒæ–¹æ³•ç›¸æ¯”ï¼Œå…·æœ‰éšç©ºé—´æ•°æ®å¢å¼ºçš„ååŒè®­ç»ƒåœ¨å¹³å‡ Dice æé«˜äº†15%ã€‚</p>
<h2 id="1-introduction">1 Introduction<a hidden class="anchor" aria-hidden="true" href="#1-introduction">#</a></h2>
<p>å°†åŸºäºæ·±åº¦å­¦ä¹ çš„æ–¹æ³•éƒ¨ç½²åˆ°å®é™…åº”ç”¨ä¸­çš„ä¸€ä¸ªä¸»è¦éšœç¢æ˜¯ä¸´åºŠéƒ¨ç½²è¿‡ç¨‹ä¸­çš„<strong>åŸŸè½¬ç§»ï¼ˆdomain shiftï¼‰</strong>ï¼Œå…¶ä¸­åŒ…æ‹¬ä¸åŒåŒ»ç–—ä¸­å¿ƒå’Œæ‰«æä»ªçš„å›¾åƒå¤–è§‚å’Œå¯¹æ¯”åº¦çš„å˜åŒ–ï¼Œä»¥åŠå„ç§æˆåƒä¼ªå½±ã€‚åœ¨  Multi-domain datasets ä¸Šå­¦ä¹ åŸŸä¸å˜çš„ç‰¹å¾è¿›è¡Œåˆ†å‰²å¯ä»¥è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œä½†æ˜¯ Multi-domain æ•°æ®çš„è·å–æˆæœ¬è¾ƒé«˜ï¼Œå› æ­¤ä» <strong>single-domain</strong> å’Œæœ‰é™çš„æ•°æ®ä¸­å­¦ä¹ ç¨³å¥çš„ç½‘ç»œï¼Œå¯¹åŒ»å­¦å½±åƒç ”ç©¶å…·æœ‰é‡è¦çš„å®ç”¨ä»·å€¼ã€‚</p>
<p>æœ¬ç¯‡è®ºæ–‡æå‡ºäº†ä¸€ä¸ªæ–°çš„ååŒè®­ç»ƒæ¡†æ¶ï¼Œç”¨äºä» single-domain æ•°æ®ä¸­å­¦ä¹ åˆ°ä¸€ä¸ªç¨³å¥çš„åˆ†å‰²ç½‘ç»œã€‚ä¸»è¦è´¡çŒ®å¯ä»¥æ€»ç»“å¦‚ä¸‹ï¼š</p>
<p><!-- raw HTML omitted -->ï¼ˆ1ï¼‰è®¾è®¡äº†ä¸€ä¸ªç”±ä¸¤ä¸ªç½‘ç»œç»„æˆçš„ååŒè®­ç»ƒæ¡†æ¶<!-- raw HTML omitted --></p>
<p>è¿™ä¸ªæ¡†æ¶å¯å‘è‡ªäººç±»è¡Œä¸ºä¸­çš„åŒç³»ç»Ÿæ¨¡å‹ï¼š<strong>å¿«é€Ÿæ€ç»´ç³»ç»Ÿ</strong>åšå‡ºç›´è§‰åˆ¤æ–­ï¼Œè€Œ<strong>æ…¢é€Ÿæ€ç»´ç³»ç»Ÿ</strong>åˆ™é€šè¿‡é€»è¾‘æ¨ç†è¿›è¡Œçº æ­£ã€‚</p>
<p>å¯¹åº”åˆ°æ¡†æ¶ä¸­ï¼Œfast-thinking network (FTN) æ—¨åœ¨ç†è§£å›¾åƒçš„ä¸Šä¸‹æ–‡ï¼Œå¹¶æå–ä¸ä»»åŠ¡ç›¸å…³çš„å›¾åƒå’Œå½¢çŠ¶ç‰¹å¾è¿›è¡Œåˆå§‹åˆ†å‰²ï¼›slow-thinking network (STN) æ ¹æ®å­¦ä¹ åˆ°çš„å½¢çŠ¶å…ˆéªŒæ¥å®Œå–„åˆå§‹åˆ†å‰²ã€‚</p>
<p><!-- raw HTML omitted -->ï¼ˆ2ï¼‰æå‡ºäº†ä¸€ç§éšç©ºé—´æ•°æ®å¢å¼ºæ–¹æ³• latent space data augmentation (DA) method<!-- raw HTML omitted --></p>
<p>éšæœºå’Œæœ‰é’ˆå¯¹æ€§çš„æ–¹å¼å¯¹ä» FTN ä¸­å­¦ä¹ åˆ°çš„éšç¼–ç ï¼ˆlatent codeï¼‰è¿›è¡Œé€šé“å’Œç©ºé—´çš„é®ç›–ï¼ˆå±è”½ï¼‰ï¼Œè¿™æ ·å°±ä¼šé‡å»ºå‡ºä¸€ç»„å¤šæ ·åŒ–çš„æŒ‘æˆ˜æ€§å›¾åƒå’Œå¯¹åº”çš„åˆ†å‰²å›¾ï¼Œä»¥åŠ å¼ºä¸¤ä¸ªç½‘ç»œçš„è®­ç»ƒã€‚</p>
<h2 id="2-methodology">2 Methodology<a hidden class="anchor" aria-hidden="true" href="#2-methodology">#</a></h2>
<p>single domain dataset $D_{tr} = {(x_i, y_i)}^{n}_{i=1}$</p>
<p>image $x_i \in \mathbb{R}^{H \times W}$</p>
<p>one-hot encoded C-class label maps $y_i \in {0, 1}^{H \times W \times C}$ ï¼ˆground truthï¼‰</p>
<h3 id="21-framework">2.1 Framework<a hidden class="anchor" aria-hidden="true" href="#21-framework">#</a></h3>
<p><img loading="lazy" src="./20211024/1.png" alt=""  />
</p>
<p>ç»™å®šè¾“å…¥å›¾åƒ xï¼ŒFTN æå–ç‰¹å®šä»»åŠ¡çš„å½¢çŠ¶ç‰¹å¾ $z_s$ æ¥æ‰§è¡Œåˆ†å‰²ä»»åŠ¡ï¼Œæå–å›¾åƒä¸Šä¸‹æ–‡ç‰¹å¾ $z_i$ æ¥æ‰§è¡Œå›¾åƒé‡å»ºä»»åŠ¡ã€‚å…±äº« encoder $E_{\theta}$ï¼Œç‰¹å¾è§£è€¦å™¨ $\mathcal{H}$ï¼Œ ä¸¤ä¸ªç‰¹å®šä»»åŠ¡çš„è§£ç å™¨ $D_{\phi_s}$ã€$D_{\phi_i}$ ç”¨äºå›¾åƒåˆ†å‰²å’Œé‡å»ºä»»åŠ¡ã€‚</p>
<p>å¯¹ $z_i$ åº”ç”¨ç‰¹å¾è§£è€¦å™¨ $\mathcal{H}$ï¼Œä½¿ä¸åˆ†å‰²ä»»åŠ¡æ— å…³çš„ä¿¡æ¯ï¼ˆå¦‚å›¾åƒçº¹ç†ä¿¡æ¯ã€äº®åº¦ï¼‰åœ¨ $z_s$ ä¸­è¢«åœç”¨ï¼Œç¨€ç–çš„ $z_s$ æœ‰ç›Šäºæ¨¡å‹çš„ç¨³å¥æ€§ã€‚</p>
<p>$\mathcal{H}$ ç”±ä¸¤ä¸ªå·ç§¯å±‚å †å ï¼Œåæ¥ ReLU æ¿€æ´»å‡½æ•°ã€‚å›¾åƒé‡å»ºéœ€è¦ä½å±‚æ¬¡çš„ä¿¡æ¯ï¼Œè€Œå›¾åƒåˆ†å‰²åˆ™ä¾èµ–äºæ›´é›†ä¸­çš„é«˜å±‚æ¬¡ä¿¡æ¯ã€‚å¼•å…¥ $\mathcal{H}$ æ˜ç¡®åœ°å®šä¹‰äº†ä¸€ä¸ªåˆ†å±‚çš„ç‰¹å¾ç»“æ„ï¼Œä»¥æé«˜æ¨¡å‹çš„é€šç”¨æ€§ï¼›</p>
<p>STN æ˜¯ä¸€ä¸ªå»å™ªè‡ªåŠ¨ç¼–ç å™¨ç½‘ç»œ $C_{\psi}$ï¼Œå­¦ä¹ å½¢çŠ¶å…ˆéªŒæ¥çº æ­£ FTN é¢„æµ‹çš„åˆ†å‰²ã€‚åœ¨æ¨ç†æ—¶ï¼ŒFTN è¿›è¡Œå¯¹ç»™å®šçš„å›¾åƒ x è¿›è¡Œå¿«é€Ÿåˆ†å‰²ï¼š$p = D_{\phi_s}(\mathcal{H}(E_{\theta}(x)))$ï¼›STN å®Œå–„åˆ†å‰²ç»“æœï¼š$p&rsquo; = C_{\psi}(p)$ã€‚</p>
<h3 id="22-standard-training">2.2 Standard Training<a hidden class="anchor" aria-hidden="true" href="#22-standard-training">#</a></h3>
<p>ç”¨ç›‘ç£çš„å¤šä»»åŠ¡æŸå¤±å‡½æ•°è”åˆè®­ç»ƒä¸‰ä¸ªç¼–ç å™¨-è§£ç å™¨å¯¹ï¼ŒæŸå¤±åŒ…å«ï¼šå›¾åƒé‡å»º $L_{rec}$ã€å›¾åƒåˆ†å‰² $L_{seg}$ã€å½¢çŠ¶æ ¡æ­£ $L_{shp}$ã€‚</p>
<p><img loading="lazy" src="./20211024/2.png" alt=""  />
</p>
<ul>
<li>$L_{rec}$ æ˜¯ Mean Squared Error(MSE)</li>
<li>$L_{seg}, L_{shp}$ æ˜¯ cross-entropy function</li>
<li>$y&rsquo; = C_{\psi}(y)$</li>
</ul>
<h3 id="23-latent-space-data-augmentation-for-hard-example-generation">2.3 Latent Space Data Augmentation for Hard Example Generation<a hidden class="anchor" aria-hidden="true" href="#23-latent-space-data-augmentation-for-hard-example-generation">#</a></h3>
<p>ä¸ºäº†ç¼“è§£è¿‡æ‹Ÿåˆï¼Œæå‡ºäº† latent space DA methodï¼Œä½¿å¾— FTN å¯ä»¥è‡ªåŠ¨æ„å»ºå…·æœ‰æŒ‘æˆ˜æ€§çš„æ ·æœ¬ã€‚</p>
<p><img loading="lazy" src="./20211024/1.png" alt=""  />
</p>
<p>æ©ç ç”Ÿæˆå™¨ $\mathcal{G}$  åœ¨ latent code $z$ ä¸Šäº§ç”Ÿä¸€ä¸ªæ©ç  mï¼Œä¹‹å $\hat{z} = z \cdot m$ è¾“å…¥åˆ°è§£ç å™¨é‡æ„å‡ºè¢«ç ´åçš„å›¾åƒ $\hat{x} = D_{\phi_i}(\hat{z_i})$ å’Œå…¶å¯¹åº”çš„åˆ†å‰²å›¾ $\hat{p} = D_{\phi_s}(\hat{z_s})$ã€‚è¿™å°±æ˜¯  latent code masking æ•°æ®å¢å¼ºæ–¹æ³•ã€‚</p>
<p>é€šè¿‡åŠ¨æ€å±è”½ latent codeï¼Œæ‰€æå‡ºçš„æ–¹æ³•å¯ä»¥ç”Ÿæˆå…·æœ‰å¹¿æ³›å¤šæ ·æ€§çš„å›¾åƒå¤–è§‚å’Œåˆ†å‰²çš„æ ·æœ¬ã€‚å¦‚ä¸‹ä»‹ç»å‡ ç§ latent-code masking æ–¹æ¡ˆï¼š</p>
<p>ï¼ˆ1ï¼‰Random Masking with Dropout</p>
<p>latent-code çš„æ•´ä¸ªé€šé“åœ¨è®­ç»ƒæ—¶ä»¥ p çš„æ¦‚ç‡è¢«æ©ç›–ä¸ºå…¨é›¶ã€‚</p>
<p><img loading="lazy" src="./20211024/3.png" alt=""  />
</p>
<p>è¢«é®ç›–åç¬¬ i ä¸ªé€šé“çš„ç»“æœä¸ºï¼š$\hat{z}^{(i)} = z^{(i)} \cdot m^{(i)}$ã€‚$z \in \mathbb{R}^{c \times h \times w}$ã€‚</p>
<p>ï¼ˆ2ï¼‰Target Masking</p>
<p>æå‡ºäº†æœ‰é’ˆå¯¹æ€§çš„ latent-code masking æ–¹æ¡ˆï¼Œè¯¥æ–¹æ¡ˆä»¥æ¢¯åº¦ä¸ºçº¿ç´¢æ¥è¯†åˆ«è¦æ©è”½çš„â€œçªå‡ºâ€ç‰¹å¾ã€‚ é‡‡å–å›¾åƒé‡å»ºæŸå¤±å’Œå›¾åƒåˆ†å‰²æŸå¤±ï¼Œåˆ†åˆ«è®¡ç®— $z_i$ å’Œ $z_s$ çš„æ¢¯åº¦ $g_{z_i}$å’Œ $g_{z_s}$ã€‚</p>
<p><img loading="lazy" src="./20211024/4.png" alt=""  />
</p>
<p>å¯¹æ¢¯åº¦å€¼è¿›è¡Œæ’åºï¼Œå¯ä»¥ç¡®å®šå‡ºé‚£äº›<strong>æœ€å…·é¢„æµ‹æ€§</strong>çš„å…ƒç´ ã€‚ä½œè€…å‡è®¾ï¼Œå¯¹æŸå¤±å‡½æ•°ååº”è¾ƒé«˜çš„å…ƒç´ æ˜¯å¯¼è‡´åœ¨ä¸å¯é¢„è§çš„åŸŸè½¬ç§»ä¸‹æ€§èƒ½ä¸‹é™çš„ä¸»è¦åŸå› ã€‚å› æ­¤ï¼Œå¯¹è¿™ç§å…ƒç´ è¿›è¡Œæœ‰é’ˆå¯¹æ€§çš„é®è”½ï¼Œä»¥<strong>æ¨¡æ‹Ÿæ•°æ®åˆ†å¸ƒçš„è½¬ç§»ï¼ˆdata distribution shiftsï¼‰</strong>ã€‚å¯ä»¥åœ¨é€šé“ç»´åº¦å’Œç©ºé—´ç»´åº¦é®è”½ latent-code $z$  çš„ç‰¹å¾ã€‚</p>
<p><img loading="lazy" src="./20211024/5.png" alt=""  />
</p>
<ul>
<li>$z^{ch}_p, z^{sp}_p$ é˜ˆå€¼</li>
<li>a æ˜¯ (0, 0.5) ä¹‹é—´éšæœºæŠ½å–çš„é€€ç«ç³»æ•°ï¼Œåˆ›å»º soft masksï¼›</li>
</ul>
<p>Channel-wise masked code at i-th channelï¼š</p>
<p>$\hat{z}^{(i)} = z^{(i)} \cdot m^{(i)}$</p>
<p>Spatial-wise masked code at (j, k) positionï¼š</p>
<p>$\hat{z}^{(j, k)} = z^{(j, k)} \cdot m^{(j, k)}$</p>
<h3 id="24-ååŒè®­ç»ƒ">2.4 ååŒè®­ç»ƒ<a hidden class="anchor" aria-hidden="true" href="#24-ååŒè®­ç»ƒ">#</a></h3>
<p>è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œéšæœºåœ°å°†ä¸Šé¢ä»‹ç»çš„ä¸‰ç§ mask generator åº”ç”¨äº $z_i, z_s$ï¼Œè¿™ä¸ªæ“ä½œç”Ÿæˆä¸€ç»„ä¸°å¯Œçš„å¢å¼ºå›¾åƒ $\hat{x}$ å’Œåˆ†å‰²å›¾ $\hat{p}$ã€‚è¿™å°±å¾—åˆ° 3 example pairs ç”¨äºè®­ç»ƒï¼š</p>
<ul>
<li>corrupted images-clean images $(\hat{x}, x)$</li>
<li>corrupted images-GT $(\hat{x}, y)$</li>
<li>corrupted GT-GT $(\hat{p}, y)$</li>
</ul>
<p>åˆä½œè®­ç»ƒçš„æœ€ç»ˆæŸå¤±å®šä¹‰ä¸ºç®€å•ä¾‹å­å’Œå›°éš¾ä¾‹å­ä¸Šçš„æŸå¤±çš„ç»„åˆã€‚</p>
<p><img loading="lazy" src="./20211024/6.png" alt=""  />
</p>
<h2 id="3-experiments-and-results">3 Experiments and Results<a hidden class="anchor" aria-hidden="true" href="#3-experiments-and-results">#</a></h2>
<p>åº”ç”¨ä¸å¿ƒè„å›¾åƒåˆ†å‰²ä»»åŠ¡ï¼Œä» MR å›¾åƒä¸­åˆ†å‰²å‡ºå·¦å¿ƒå®¤è…”ã€å·¦å¿ƒå®¤å¿ƒè‚Œå’Œå³å¿ƒå®¤ã€‚</p>
<p>æ•°æ®é›†ï¼š</p>
<ul>
<li>
<p>ACDCï¼šè®­ç»ƒã€intra-domain æµ‹è¯•</p>
</li>
<li>
<p>M&amp;Msï¼šcross-domain æµ‹è¯•</p>
</li>
<li>
<p>ACDC-C (corrupted ACDC)ï¼šè¯„ä¼°æ•°æ®å¢å¼ºæ–¹æ³•çš„é²æ£’æ€§</p>
</li>
</ul>
<p>ï¼ˆ1ï¼‰å®éªŒ 1ï¼šStandard Training vs Cooperative Training</p>
<p><img loading="lazy" src="./20211024/7.png" alt=""  />
</p>
<ul>
<li>ä¸¤ç§æ–¹æ³•åœ¨åŸŸå†…æµ‹è¯•é›†ä¸Šå–å¾—äº†ç›¸è¿‘çš„æ€§èƒ½ï¼›</li>
<li>åŒç½‘ç»œï¼ˆFTN+STNï¼‰çš„ååŒè®­ç»ƒåœ¨åŸŸå¤–æµ‹è¯•é›†ä¸Šå–å¾—äº†æ›´é«˜çš„æ€§èƒ½ï¼›</li>
<li>éšç©ºé—´æ•°æ®å¢å¼ºæ–¹æ³•æ•°æ®ä¸Šï¼ŒååŒè®­ç»ƒä¹Ÿè¡¨ç°å‡ºäº†å…¶ä¼˜è¶Šæ€§ã€‚</li>
</ul>
<p>ï¼ˆ2ï¼‰å®éªŒ 2: Latent Space DA vs Image Space DA</p>
<p><img loading="lazy" src="./20211024/8.png" alt=""  />
</p>
<p><img loading="lazy" src="./20211024/9.png" alt=""  />
</p>
<p>Table 1 ä¸­ AdvBias åœ¨ M&amp;Ms æ•°æ®é›†å’Œ RandBias ä¸Šå–å¾—äº†æœ€å¥½çš„æ€§èƒ½ï¼Œä½†è¿™ç§æ–¹æ³•æœ‰ä¸€ä¸ªå‰¯ä½œç”¨ï¼Œä½¿å…¶å¯¹å°–å³°ä¼ªå½±æ›´åŠ æ•æ„Ÿï¼ˆDice å¾—åˆ† 0.4901 vs 0.3840ï¼‰ã€‚latent-space DA åœ¨å…­ä¸ªæ•°æ®é›†ä¸Šå–å¾—äº†æœ€é«˜çš„å¹³å‡æ€§èƒ½ã€‚</p>
<p>å›¾ 3. æœ¬ç¯‡è®ºæ–‡çš„æ–¹æ³•ä¸ä»…å¯ä»¥ç”Ÿæˆæ‰°åŠ¨çš„å›¾åƒï¼Œè¿˜å¯ä»¥ç”Ÿæˆä¸ç¡®å®šæ€§å¢åŠ çš„çœŸå®çš„æŸåçš„åˆ†å‰²ã€‚</p>
<p>ï¼ˆ3ï¼‰å®éªŒ 3ï¼šAblation Study</p>
<p>(a) the proposed targeted masking; b) latent code decoupler <em>H</em>; c) cooperative training.</p>
<p><img loading="lazy" src="./20211024/10.png" alt=""  />
</p>
<ul>
<li>ç¦ç”¨ $\mathcal{G}<em>{ch}ã€\mathcal{G}</em>{sp}$ åï¼Œå¹³å‡ Dice å¾—åˆ†ä» 0.6901 é™è‡³ 0.6584ï¼›</li>
<li>å›¾åƒé‡å»ºéœ€è¦ä½å±‚æ¬¡çš„ä¿¡æ¯ï¼Œè€Œå›¾åƒåˆ†å‰²åˆ™ä¾èµ–äºæ›´é›†ä¸­çš„é«˜å±‚æ¬¡ä¿¡æ¯ã€‚å¼•å…¥ Hæ˜ç¡®åœ°å®šä¹‰äº†ä¸€ä¸ªåˆ†å±‚çš„ç‰¹å¾ç»“æ„ï¼Œä»¥æé«˜æ¨¡å‹çš„é€šç”¨æ€§ï¼›</li>
<li>çªå‡ºäº†åˆä½œè®­ç»ƒç­–ç•¥åŠ å¼ºåŸºäºå­¦ä¹ çš„å½¢çŠ¶ç»†åŒ–å’Œä¿®æ­£ï¼›</li>
</ul>
<h2 id="4-conclusion">4 Conclusion<a hidden class="anchor" aria-hidden="true" href="#4-conclusion">#</a></h2>
<ul>
<li>æå‡ºäº†ä¸€ä¸ªæ–°çš„ååŒè®­ç»ƒæ¡†æ¶ï¼Œä»¥åŠä¸€ä¸ª latent space masking-based çš„æ•°æ®å¢å¼ºæ–¹æ³•ï¼›</li>
<li>å®éªŒéªŒè¯äº†æ¨¡å‹çš„é€šç”¨æ€§å’Œå¯¹ä¸å¯é¢„è§çš„é¢†åŸŸè½¬å˜çš„é²æ£’æ€§ï¼›</li>
<li>latent-space DA æ–¹æ³•åªéœ€è¦å¾ˆå°‘çš„ä»£ä»·ï¼›</li>
<li>ç›®å‰åªåœ¨å¿ƒè„å›¾åƒåˆ†å‰²ä¸Šå±•ç¤ºäº†å…¶æ€§èƒ½ï¼Œè¯¥é€šç”¨æ¡†æ¶æœ‰å¯èƒ½æ‰©å±•åˆ°å¹¿æ³›çš„æ•°æ®é©±åŠ¨çš„åº”ç”¨ã€‚</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://landodo.github.io/tags/%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA/">æ•°æ®å¢å¼º</a></li>
      <li><a href="http://landodo.github.io/tags/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">è®ºæ–‡é˜…è¯»</a></li>
      <li><a href="http://landodo.github.io/tags/%E5%8C%BB%E5%AD%A6%E5%9B%BE%E5%83%8F%E5%88%86%E5%89%B2/">åŒ»å­¦å›¾åƒåˆ†å‰²</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://landodo.github.io/posts/20211105-2-5d-network/">
    <span class="title">Â« Prev Page</span>
    <br>
    <span>2.5D methods for Volumetric Medical Image Segmentation</span>
  </a>
  <a class="next" href="http://landodo.github.io/posts/20210924-3d-roi-aware-u-net/">
    <span class="title">Next Page Â»</span>
    <br>
    <span>3D RoI-aware U-Net for Accurate and Efficient Colorectal Tumor Segmentation</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>Landon</span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
