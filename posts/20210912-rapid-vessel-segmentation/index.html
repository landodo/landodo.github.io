<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                {left: "$$", right: "$$", display: true},
                {left: "$", right: "$", display: false}
            ]
        });
    });
</script>
<meta name="robots" content="index, follow">
<title>Rapid vessel segmentation and reconstruction of head and neck angiograms using 3D convolutional neural network. | Landodo&#39;s NoteBook</title>
<meta name="keywords" content="论文阅读, 医学图像分割" />
<meta name="description" content="论文简介 基于三维卷积神经网络的头颈部血管图像快速分割与重建 Fu, F., Wei, J., Zhang, M., Yu, F., Xiao, Y., Rong, D., Shan, Y., Li, Y., Zhao, C., Liao, F., Yang, Z., Li, Y., Chen, Y., Wang, X., &amp; Lu, J. (2020). Rapid vessel segmentation and reconstruction of head and neck">
<meta name="author" content="">
<link rel="canonical" href="http://landodo.github.io/posts/20210912-rapid-vessel-segmentation/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css" integrity="sha256-yIlj/i15RiAA/Q&#43;xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js" integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="http://landodo.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://landodo.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://landodo.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://landodo.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="http://landodo.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Rapid vessel segmentation and reconstruction of head and neck angiograms using 3D convolutional neural network." />
<meta property="og:description" content="论文简介 基于三维卷积神经网络的头颈部血管图像快速分割与重建 Fu, F., Wei, J., Zhang, M., Yu, F., Xiao, Y., Rong, D., Shan, Y., Li, Y., Zhao, C., Liao, F., Yang, Z., Li, Y., Chen, Y., Wang, X., &amp; Lu, J. (2020). Rapid vessel segmentation and reconstruction of head and neck" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://landodo.github.io/posts/20210912-rapid-vessel-segmentation/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-09-16T09:17:12&#43;08:00" />
<meta property="article:modified_time" content="2021-09-16T09:17:12&#43;08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Rapid vessel segmentation and reconstruction of head and neck angiograms using 3D convolutional neural network."/>
<meta name="twitter:description" content="论文简介 基于三维卷积神经网络的头颈部血管图像快速分割与重建 Fu, F., Wei, J., Zhang, M., Yu, F., Xiao, Y., Rong, D., Shan, Y., Li, Y., Zhao, C., Liao, F., Yang, Z., Li, Y., Chen, Y., Wang, X., &amp; Lu, J. (2020). Rapid vessel segmentation and reconstruction of head and neck"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://landodo.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Rapid vessel segmentation and reconstruction of head and neck angiograms using 3D convolutional neural network.",
      "item": "http://landodo.github.io/posts/20210912-rapid-vessel-segmentation/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Rapid vessel segmentation and reconstruction of head and neck angiograms using 3D convolutional neural network.",
  "name": "Rapid vessel segmentation and reconstruction of head and neck angiograms using 3D convolutional neural network.",
  "description": "论文简介 基于三维卷积神经网络的头颈部血管图像快速分割与重建 Fu, F., Wei, J., Zhang, M., Yu, F., Xiao, Y., Rong, D., Shan, Y., Li, Y., Zhao, C., Liao, F., Yang, Z., Li, Y., Chen, Y., Wang, X., \u0026amp; Lu, J. (2020). Rapid vessel segmentation and reconstruction of head and neck",
  "keywords": [
    "论文阅读", "医学图像分割"
  ],
  "articleBody": "论文简介 基于三维卷积神经网络的头颈部血管图像快速分割与重建\n Fu, F., Wei, J., Zhang, M., Yu, F., Xiao, Y., Rong, D., Shan, Y., Li, Y., Zhao, C., Liao, F., Yang, Z., Li, Y., Chen, Y., Wang, X., \u0026 Lu, J. (2020). Rapid vessel segmentation and reconstruction of head and neck angiograms using 3D convolutional neural network. Nature communications, 11(1), 4829. https://doi.org/10.1038/s41467-020-18606-2\n Publish Year: 2020\n期刊：Nature Communications\n下载地址：https://www.nature.com/articles/s41467-020-18606-2.pdf\n摘要 计算机断层扫描血管造影图像（ computed tomography angiography, CTA）的后处理（分割、重建）操作时一项非常消耗时间、且易于出错的任务。本片论文提出了一种充分利用生理解剖学的 3D 卷积神经网络 CTA 重建系统。\n数据集来自中国 5 家三甲医院的 18766 例头颈部 CTA 扫描图像。最后的结果为 DSC = 0.931，该系统的结果与人工处理的图像具有一致性，符合临床要求，临床评估结果合格率为 92.1%。\n该系统部署应用 5 个月之后，对于每一个病例的处理时间从 $14.22\\pm 3.64$ 减少到 $4.96 \\pm 0.36$ 分钟，促进了临床工作流程。\nIntroduction 计算机断层血管造影（CTA）是一种广泛的、微创的、经济有效的成像方式，用于头颈部血管的常规临床诊断。可视化分析头颈部的血管系统（血管成像重建）通常由经验丰富的计算机断层扫描技术人员进行。\n血管是曲折和有分支的，因此，准确的血管分割、保证连续性（不中断）是一个具有挑战性的任务。除此之外，分割还容易受到其他组织的影响，如颅内入口血管的 CT值与颅骨 CT 值高度相似，这可能导致血管外组织粘连，影响后续疾病诊断。\n深度神经网络架构是克服上述技术障碍的最有效途径。U-Net 已经被证实了其在医学图像分析中的应用前景。3D CNN 符合生理解剖，目标图像的形态学特征是专门为分割任务设计的。\n本篇论文开发了一种基于优化解剖学先验知识的 3D-CNN 自动成像重建系统（CerebralDoc，脑科医生），用于重建原始的头颈部 CTA 图像，帮助工作人员建立节省时间的工作流程。\n最后，对 CerebralDoc 进行全面评估，结果表明，将人工智能技术集成到放射科工作流程中，能大幅度提高工作流程效率，降低医疗成本。\nResults 患者及影像特征\n数据集包含 18766 例头颈部 CTA 扫描的患者，手工筛选排除 507 例低质量图像。表 1 总结了用于训练、验证和独立测试的 CTA 扫描数据集。\n模型性能\n数据增强后，有 91,295 例（扩增了 5 倍）用于训练。3D-CNN 使用使得 U-Net + bottleneck-ResNet（ResU-Net）。CerebralDoc 系统分为两个主要部分：\n ResU-Net：主要负责骨分割和血管提取； connected growth prediction model (CGPM). 关联增长预测模型：负责曹正血管的连续性；  模型训练过程包括骨分割和血管分割。血管分割（Vessel Segmentation）和 Bone Segmentation 的 DSC、V-score、Recall 如下 Fig.2。\nCerebralDoc 的临床评估\n AI 和手工处理在整体临床评估数据集和不同疾病中的 5 分评级分布； Fig 4 直接呈现由 CerebralDoc 和手工处理生成的图像； 两图都得出相同结论：CerebralDoc 和人类输出之间没有统计学上的显著差异（图 3a和 4）。   VR 和 MIP 中 AI 与人工处理的比较； 人工处理中右侧大脑中动脉闭塞，未重建侧支循环（a），AI 成功重建侧支循环（b）； AI 比人工处理的图像更清晰，尤其是海绵窦段（c-d） 在 CerebralDoc 中，由于算法中的自动骨分割，所有的 MIP 图像都被评分为3分（被认为有中度骨残留但不影响血管观察）。  CerebralDoc 的临床应用效果\n 所有接受头颈部 CTA 检查的患者，包括动脉粥样硬化性溃疡、动脉瘤、烟雾病、颈部支架植入术的患者，均使用 CerebralDoc。   2019 年 7 月至 11 月，宣武医院临床共 3430 例患者行头颈部 CTA 扫描；经经验丰富的技术人员评价，成功重建 3122 例(91.0%)。最后，将 2649 张重建图像应用于临床(图7a)。而且，随着医生信任度的提高，重建图像被推送到诊所的概率从 243 逐渐增加到 753 (图7b)。  比较 CerebralDoc 与手工处理的性能\n两位技术人员手工处理一个病例的平均耗时为：13.48 ± 3.67、14.95 ± 3.65 分钟，使用 CerebralDoc 后耗时为 14.22 ±3.64、4.94 ± 0.36 分钟。点击次数的差异更为巨大。\nDiscussion 提出了 CGPM 来修正血管分割错误，避免部分缺失血管。此外，作者们在宣武医院将 CerebralDoc 应用于临床场景，利用人工智能重建直接用于头颈部血管疾病诊断的 CTA 图像。\n结果表明：3D-CNN 深度学习算法可以在各种增强 CTA 扫描中以高灵敏度和特异性自动完成骨骼和血管分割（包括主动脉、颈动脉和颅内动脉）。\nCerebralDoc 重建的图片质量由两名临床经验丰富的放射科医师进行评估，合格率为 92.1%。\n以往将深度学习用于血管分割任务的研究大多集中在算法优化和模型结构方面，这些工作促使我们开发了一种有针对性的自动化临床血管分割工具(补充表2)。\n Y-Net：对 49 例磁共振血管造影（MRA）数据进行颅内动脉三维分割，测试集的精度为 0.819； HalfU-Net：脑血管病患者(TOF)-MRA 血管分割，DSC=0.88； MS-Net：全分辨率分割算法，提高了分割精度和分割精度，并显著降低了监督成本；  大部分的工作主要集中在特定血管区域的分割，而完整的头颈部 CT 扫描包括三种不同大小的血管（主动脉、颈动脉和颅内血管），这使得模型很难捕捉到跨尺寸级别的血管特征。\n另一方面，以前的大多数研究都是由相对较小的有限的数据集得来的，缺乏来自真实临床数据的验证。\n因此，通过优化的基于生理解剖学的 3D-CNN，在保证最大 patch 大小（256 × 256 × 256 体素）的前提下，建立一个全面的管道，实现头颈部 CTA 自动后处理（分割重建），具有重要的临床意义。\nU-Net 于 2015 年提出，之前的研究使用了这种策略，将大图像裁剪成小碎片，导致整体血管的结构特征丧失。考虑到血管完整性的重要性，本片论文的策略采用裁剪的方式将原始的 3D 切片输入到 3D CNN 中，并使用残差块 bottleneck-ResNet (BR) 对 U-Net 架构进行修改，从而自动找到优化的模型参数。\n连接三个不同大小层次的血管只仍然是一个挑战。基于生理解剖信息，我们将整个体积划分为三个区域（主动脉、颈动脉和颅内区域）用于网络，以更好地提取不同大小血管的特征。\n此外，还提出了 CGPM，通过对没有标注的原始 CTA 图像的输入数据、ResNet1、ResNet2 和 ResNet3 产生的当前分割结果以及标注的 CTA 图像进行学习，修正血管分割的错误，有效避免部分血管的缺失。\n由于从主动脉到颅骨范围广，且脑动脉血管曲折分支，很少有研究从头颈部 CTA 扫描中对血管分割进行研究（文中又列出一些）。本文的研究是一项多中心、大样本的研究，按照临床后处理过程，完成主动脉至颅内动脉的骨分割和血管分割的自动框架。\nCerebralDoc 在的评估结果在不同疾病中的整体合格率和表现与手工加工没有显著差异。\n3D-CNN 可以学习血管特征，更准确地改善和捕获血管信号。\nCerebralDoc 仍存在一定的局限性：\n（1）头颈部动脉严重异常起源（除左椎体直接产生于主动脉和严重狭窄起源外的异常血管常规）的患者图像不包括在训练和验证集中。因此，需要进一步的临床收集和测试来评估各种形式的颅骨和颈部血管的临床准确性。由于这种畸形的发生率相对较低，所以这个问题并不影响最终的整体结论；\n（2）未进行噪声图像进行测试；\n（3）CerebralDoc 目前只适用于 head and neck CTA images。\n总结，CerebralDoc 是一个实用的头颈部 CTA 重建系统。与现有的 CTA 图像优化重建技术相比，它提供了一种省时、不依赖主观性的方法，节省了成本，提高了效率。基于人工智能的标准化自动 U-Net 和可视化后处理图像的生成，CerebralDoc 有潜力融入目前的放射手术工作流程。\nMethods 数据的准备\n数据集包含 18766 例头颈部 CTA 原始造影增强图像，有中国 5 家三甲医院提供。所有头颈部 CTA 图像扫描包括主动脉、颈动脉和颅内动脉，Z 轴的切片为 561~967 slices。\n人工初步筛查排除了 507 例低质量的数据。所有患者 CTA 图像均为 DICOM 格式。\n本研究的初步获取了 2018 年 1 月至 2019 年 2 月期间，4 家不同的 CT 制造商的 18259 例患者的 14461128 张头颈部 CTA 扫描图像。\n训练集：16433 例患者\n测试机：1826 例患者\n训练时，将 16433 例患者分给两个模型，Model 1 进行骨分割（6387 例），Model 2 进行血管分割（10046）。\n在进行临床评估时，从宣武医院获取 2019 年 5 月至 2019 年 6 月期间额外的 152 例进行评估。这些数据依然是有标注的数据，两名经验丰富的临床医生，随机采用 5 分制评估影像质量是否满足诊断要求（医生不被告知来源手工标注还是 AI 输出）。\n最后，搜集临床应用集，主要用于验证模型在 7 ~ 11 月真实临床应用场景下的性能。\n放射科医生标注\n为了减少人为误差，采样分层标注的方法。具体来说：\n（1）首先使用 ITK-SNAP 对 18259 例样本进行预标注，分别标记骨、主动脉、颈动脉和颅内动脉区域，它们被分为四类。\n（2）由 10 名 2+ 年经验的技术人员矫正预标注图像；\n（3）由 2 名 5+ 年经验的放射科医生进行复核。如果两名医生意见不一致，则请 10+ 年经验的医生做最后决策；\n每例数据所需的平均处理时间约为 22 分钟。\n数据预处理和图像增强\n尽管标注非常专业和严谨，但是仍然会存在零散噪声。解决的方法是连通分量检测算法（a connected component detection algorithm），消除了散射噪声，提高了数据的鲁棒性。\n数据增强策略：\n 水平翻转 不高于 25° 的旋转 不高于 20 pixel 的水平/垂直平移 选择一个矩形区域，随机擦除像素、随机遮挡  经过增强后，数据量由 N 增大到 5N。为了增强鲁棒性，在训练时还加入了高斯噪声。\n模型开发\n自动分割框架包含三个级联的 ResU-Net，完成去骨、提取血管。ResU-Net2 是专门为 Bone edge optimization 设计的，CGPM 用于消除血管分割错误，有效避免部分或缺失的血管节段。\nResU-Net1 和 ResUNet2 模型负责在相同的高分辨率下使用语义分割对整个骨骼进行分割，并根据动脉的大小学习将血管划分为主动脉、颈动脉和颅内动脉的生理解剖结构特征。\n根据生理解剖结构，采用 ResU-Net3 模型实现血管分割。\n最后，提出的 CGPM 被应用于固定任何破裂的血管，并确保它们可以在形态学水平上被可行地预测和识别。\nCGPM 基于 3D-CNN，输入数据包括：\n original CTA image without labeling 由 ResU-Net1,2,3 生成的分割结果 标注的 CTA 图像  CGPM 能准确定位部分缺失的位置，完成对缺失血管的补充。\n消融学习，证明管道中每个部件的贡献。\n模型性能评估指标\n（1）DSC\n  Y: ground truth\n  $\\hat{Y}$: binary predictions from the neural networks\n  $|Y| + |\\hat{Y}|$: indicates the sum of each pixel value after calculating the dot product between the ground truth and the prediction.\n  （2）V-score\n、\n V-score 是根据血管的解剖和形态位置来计算的，用于揭示血管分割的连续性和完整性。 V-score 越高，血管位置越关键  （3）Recall\n被正确预测为阳性的病例所占的比例。\n临床评估\n3 =血管描绘良好，无间断，血管侧支重建良好，血管图像清晰；\n2 =正常血管轮廓，部分中断，狭窄程度与无遗漏的源图像相比有偏差；\n1 =整个血管中断，与源图像相比有严重的狭窄遗漏。\n2019年7月至11月，在宣武医院对 CerebralDoc 的临床应用价值进行了评估，主要从以下几个方面进行：\n 所有接受头颈部CTA检查的患者的覆盖率； 整体、每月、每天的后处理数量，以及成功推送到 PACS 的数量； 后处理所需的平均时间和 后处理的平均时间和 CerebralDoc 和技术员的点击次数（针对100个随机选择的病人）； 测试月份的临床生产力； 模型的错误率（探讨了原因）。  ===\n一些缩写\nvolume rendering (VR)\nmaximum intensity projection (MIP)\ncurve planar reconstruction (CPR)\ncurved multiple planar reformation (MPR)\nconnected growth prediction model (CGPM)\ncomputed tomography angiography (CTA)\nbottleneck-ResNet (BR)\ntime-of-flight(TOF)-MRA\nabsolute volume difference (AVD)\n===\n",
  "wordCount" : "4351",
  "inLanguage": "en",
  "datePublished": "2021-09-16T09:17:12+08:00",
  "dateModified": "2021-09-16T09:17:12+08:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://landodo.github.io/posts/20210912-rapid-vessel-segmentation/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Landodo's NoteBook",
    "logo": {
      "@type": "ImageObject",
      "url": "http://landodo.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://landodo.github.io/" accesskey="h" title="Landodo&#39;s NoteBook (Alt + H)">Landodo&#39;s NoteBook</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="http://landodo.github.io/search" title="🔍Search (Alt &#43; /)" accesskey=/>
                    <span>🔍Search</span>
                </a>
            </li>
            <li>
                <a href="http://landodo.github.io/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="http://landodo.github.io/archives/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="http://landodo.github.io/tags" title="Tag">
                    <span>Tag</span>
                </a>
            </li>
            <li>
                <a href="http://landodo.github.io/about" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="http://landodo.github.io/cs-zoo" title="CS ZOO">
                    <span>CS ZOO</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://landodo.github.io/">Home</a>&nbsp;»&nbsp;<a href="http://landodo.github.io/posts/">Posts</a></div>
    <h1 class="post-title">
      Rapid vessel segmentation and reconstruction of head and neck angiograms using 3D convolutional neural network.
    </h1>
    <div class="post-meta"><span title='2021-09-16 09:17:12 +0800 CST'>September 16, 2021</span>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;4351 words

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e8%ae%ba%e6%96%87%e7%ae%80%e4%bb%8b" aria-label="论文简介">论文简介</a></li>
                <li>
                    <a href="#%e6%91%98%e8%a6%81" aria-label="摘要">摘要</a></li>
                <li>
                    <a href="#introduction" aria-label="Introduction">Introduction</a></li>
                <li>
                    <a href="#results" aria-label="Results">Results</a></li>
                <li>
                    <a href="#discussion" aria-label="Discussion">Discussion</a></li>
                <li>
                    <a href="#methods" aria-label="Methods">Methods</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p><img loading="lazy" src="./20210909/1.png" alt=""  />
</p>
<h2 id="论文简介">论文简介<a hidden class="anchor" aria-hidden="true" href="#论文简介">#</a></h2>
<p>基于三维卷积神经网络的头颈部血管图像快速分割与重建</p>
<blockquote>
<p>Fu, F., Wei, J., Zhang, M., Yu, F., Xiao, Y., Rong, D., Shan, Y., Li, Y., Zhao, C., Liao, F., Yang, Z., Li, Y., Chen, Y., Wang, X., &amp; Lu, J. (2020). Rapid vessel segmentation and reconstruction of head and neck angiograms using 3D convolutional neural network. <em>Nature communications</em>, <em>11</em>(1), 4829. <a href="https://doi.org/10.1038/s41467-020-18606-2">https://doi.org/10.1038/s41467-020-18606-2</a></p>
</blockquote>
<p><strong>Publish Year:</strong> 2020</p>
<p>期刊：Nature Communications</p>
<p>下载地址：https://www.nature.com/articles/s41467-020-18606-2.pdf</p>
<h2 id="摘要">摘要<a hidden class="anchor" aria-hidden="true" href="#摘要">#</a></h2>
<p>计算机断层扫描血管造影图像（ computed tomography angiography, CTA）的后处理（分割、重建）操作时一项非常消耗时间、且易于出错的任务。本片论文提出了一种充分利用生理解剖学的 <strong>3D 卷积神经网络 CTA 重建系统</strong>。</p>
<p>数据集来自中国 5 家三甲医院的 18766 例头颈部 CTA 扫描图像。最后的结果为 DSC = 0.931，该系统的结果与人工处理的图像具有一致性，符合临床要求，临床评估结果合格率为 92.1%。</p>
<p>该系统部署应用 5 个月之后，对于每一个病例的处理时间从 $14.22\pm 3.64$ 减少到 $4.96 \pm 0.36$ 分钟，促进了临床工作流程。</p>
<h2 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h2>
<p>计算机断层血管造影（CTA）是一种广泛的、微创的、经济有效的成像方式，用于头颈部血管的常规临床诊断。可视化分析头颈部的血管系统（血管成像重建）通常由经验丰富的计算机断层扫描技术人员进行。</p>
<p>血管是曲折和有分支的，因此，准确的血管分割、保证连续性（不中断）是一个具有挑战性的任务。除此之外，分割还容易受到其他组织的影响，如颅内入口血管的 CT值与颅骨 CT 值高度相似，这可能导致血管外组织粘连，影响后续疾病诊断。</p>
<p>深度神经网络架构是克服上述技术障碍的最有效途径。U-Net 已经被证实了其在医学图像分析中的应用前景。3D CNN 符合生理解剖，目标图像的形态学特征是专门为分割任务设计的。</p>
<p>本篇论文开发了一种基于优化解剖学先验知识的 3D-CNN 自动成像重建系统（CerebralDoc，脑科医生），用于重建原始的头颈部 CTA 图像，帮助工作人员建立节省时间的工作流程。</p>
<p>最后，对 CerebralDoc 进行全面评估，结果表明，将人工智能技术集成到放射科工作流程中，能大幅度提高工作流程效率，降低医疗成本。</p>
<h2 id="results">Results<a hidden class="anchor" aria-hidden="true" href="#results">#</a></h2>
<p><strong>患者及影像特征</strong></p>
<p>数据集包含 18766 例头颈部 CTA 扫描的患者，手工筛选排除 507 例低质量图像。表 1 总结了用于训练、验证和独立测试的 CTA 扫描数据集。</p>
<p><img loading="lazy" src="./20210909/2.png" alt=""  />
</p>
<p><strong>模型性能</strong></p>
<p>数据增强后，有 91,295 例（扩增了 5 倍）用于训练。3D-CNN 使用使得 U-Net +  bottleneck-ResNet（ResU-Net）。CerebralDoc 系统分为两个主要部分：</p>
<ul>
<li>ResU-Net：主要负责骨分割和血管提取；</li>
<li>connected growth prediction model (CGPM). 关联增长预测模型：负责曹正血管的连续性；</li>
</ul>
<p><img loading="lazy" src="./20210909/3.png" alt=""  />
</p>
<p>模型训练过程包括骨分割和血管分割。血管分割（Vessel Segmentation）和 Bone Segmentation 的 DSC、V-score、Recall 如下 Fig.2。</p>
<p><img loading="lazy" src="./20210909/4.png" alt=""  />
</p>
<p><strong>CerebralDoc 的临床评估</strong></p>
<p><img loading="lazy" src="./20210909/5.png" alt=""  />
</p>
<p><img loading="lazy" src="./20210909/10.png" alt=""  />
</p>
<ul>
<li>AI 和手工处理在整体临床评估数据集和不同疾病中的 5 分评级分布；</li>
<li>Fig 4 直接呈现由 CerebralDoc 和手工处理生成的图像；</li>
<li>两图都得出相同结论：CerebralDoc 和人类输出之间没有统计学上的显著差异（图 3a和 4）。</li>
</ul>
<p><img loading="lazy" src="./20210909/6.png" alt=""  />
</p>
<ul>
<li>VR 和 MIP 中 AI 与人工处理的比较；</li>
<li>人工处理中右侧大脑中动脉闭塞，未重建侧支循环（a），AI 成功重建侧支循环（b）；</li>
<li>AI 比人工处理的图像更清晰，尤其是海绵窦段（c-d）</li>
<li>在 CerebralDoc 中，由于算法中的自动骨分割，所有的 MIP 图像都被评分为3分（被认为有中度骨残留但不影响血管观察）。</li>
</ul>
<p><strong>CerebralDoc 的临床应用效果</strong></p>
<p><img loading="lazy" src="./20210909/8.png" alt=""  />
</p>
<ul>
<li>所有接受头颈部 CTA 检查的患者，包括动脉粥样硬化性溃疡、动脉瘤、烟雾病、颈部支架植入术的患者，均使用 CerebralDoc。</li>
</ul>
<p><img loading="lazy" src="./20210909/9.png" alt=""  />
</p>
<ul>
<li>2019 年 7 月至 11 月，宣武医院临床共 3430 例患者行头颈部 CTA 扫描；经经验丰富的技术人员评价，成功重建 3122 例(91.0%)。最后，将 2649 张重建图像应用于临床(图7a)。而且，随着医生信任度的提高，重建图像被推送到诊所的概率从 243 逐渐增加到 753 (图7b)。</li>
</ul>
<p><strong>比较 CerebralDoc 与手工处理的性能</strong></p>
<p><img loading="lazy" src="./20210909/11.png" alt=""  />
</p>
<p>两位技术人员手工处理一个病例的平均耗时为：13.48 ± 3.67、14.95 ± 3.65 分钟，使用 CerebralDoc 后耗时为  14.22 ±3.64、4.94 ± 0.36 分钟。点击次数的差异更为巨大。</p>
<h2 id="discussion">Discussion<a hidden class="anchor" aria-hidden="true" href="#discussion">#</a></h2>
<p>提出了 CGPM 来修正血管分割错误，避免部分缺失血管。此外，作者们在宣武医院将 CerebralDoc 应用于临床场景，利用人工智能重建直接用于头颈部血管疾病诊断的 CTA 图像。</p>
<p>结果表明：3D-CNN 深度学习算法可以在各种增强 CTA 扫描中以高灵敏度和特异性自动完成骨骼和血管分割（包括主动脉、颈动脉和颅内动脉）。</p>
<p>CerebralDoc 重建的图片质量由两名临床经验丰富的放射科医师进行评估，合格率为 92.1%。</p>
<p>以往将深度学习用于血管分割任务的研究<strong>大多集中在算法优化和模型结构方面</strong>，这些工作促使我们开发了一种有针对性的自动化临床血管分割工具(补充表2)。</p>
<ul>
<li>Y-Net：对 49 例磁共振血管造影（MRA）数据进行颅内动脉三维分割，测试集的精度为 0.819；</li>
<li>HalfU-Net：脑血管病患者(TOF)-MRA 血管分割，DSC=0.88；</li>
<li>MS-Net：全分辨率分割算法，提高了分割精度和分割精度，并显著降低了监督成本；</li>
</ul>
<p>大部分的工作主要集中在特定血管区域的分割，而完整的头颈部 CT 扫描包括三种不同大小的血管（主动脉、颈动脉和颅内血管），这使得模型很难捕捉到跨尺寸级别的血管特征。</p>
<p>另一方面，以前的大多数研究都是由相对较小的有限的数据集得来的，缺乏来自真实临床数据的验证。</p>
<p>因此，通过优化的基于生理解剖学的 3D-CNN，在保证最大 patch 大小（256 × 256 × 256 体素）的前提下，建立一个全面的管道，实现头颈部 CTA 自动后处理（分割重建），具有重要的临床意义。</p>
<p>U-Net 于 2015 年提出，之前的研究使用了这种策略，将大图像裁剪成小碎片，导致整体血管的结构特征丧失。考虑到血管完整性的重要性，本片论文的策略采用裁剪的方式将原始的 3D 切片输入到 3D CNN 中，并使用残差块 bottleneck-ResNet (BR) 对 U-Net 架构进行修改，从而自动找到优化的模型参数。</p>
<p>连接三个不同大小层次的血管只仍然是一个挑战。基于生理解剖信息，我们将整个体积划分为三个区域（主动脉、颈动脉和颅内区域）用于网络，以更好地提取不同大小血管的特征。</p>
<p>此外，还提出了 CGPM，通过对<strong>没有标注的原始 CTA 图像的输入数据</strong>、ResNet1、ResNet2 和 ResNet3 产生的当前分割结果以及标注的 CTA 图像进行学习，修正血管分割的错误，有效避免部分血管的缺失。</p>
<p>由于从主动脉到颅骨范围广，且脑动脉血管曲折分支，很少有研究从头颈部 CTA 扫描中对血管分割进行研究（文中又列出一些）。本文的研究是一项多中心、大样本的研究，按照临床后处理过程，完成主动脉至颅内动脉的骨分割和血管分割的自动框架。</p>
<p>CerebralDoc 在的评估结果<strong>在不同疾病中的整体合格率和表现与手工加工没有显著差异</strong>。</p>
<p>3D-CNN 可以学习血管特征，更准确地改善和捕获血管信号。</p>
<p>CerebralDoc 仍存在一定的局限性：</p>
<p>（1）头颈部动脉严重异常起源（除左椎体直接产生于主动脉和严重狭窄起源外的异常血管常规）的患者图像不包括在训练和验证集中。因此，需要进一步的临床收集和测试来评估各种形式的颅骨和颈部血管的临床准确性。由于这种畸形的发生率相对较低，所以这个问题并不影响最终的整体结论；</p>
<p>（2）未进行噪声图像进行测试；</p>
<p>（3）CerebralDoc 目前只适用于 head and neck CTA images。</p>
<p>总结，CerebralDoc 是一个实用的头颈部 CTA 重建系统。与现有的 CTA 图像优化重建技术相比，它提供了一种省时、不依赖主观性的方法，节省了成本，提高了效率。基于人工智能的标准化自动 U-Net 和可视化后处理图像的生成，CerebralDoc 有潜力融入目前的放射手术工作流程。</p>
<h2 id="methods">Methods<a hidden class="anchor" aria-hidden="true" href="#methods">#</a></h2>
<p><strong>数据的准备</strong></p>
<p>数据集包含 <strong>18766 例</strong>头颈部 CTA 原始造影增强图像，有中国 5 家三甲医院提供。所有头颈部 CTA 图像扫描包括主动脉、颈动脉和颅内动脉，Z 轴的切片为 561~967 slices。</p>
<p>人工初步筛查排除了 507 例低质量的数据。所有患者 CTA 图像均为 DICOM 格式。</p>
<p>本研究的初步获取了 2018 年 1 月至 2019 年 2 月期间，4 家不同的 CT 制造商的 18259 例患者的 14461128 张头颈部 CTA 扫描图像。</p>
<p>训练集：16433 例患者</p>
<p>测试机：1826 例患者</p>
<p>训练时，将 16433 例患者分给两个模型，Model 1 进行骨分割（6387 例），Model 2 进行血管分割（10046）。</p>
<p>在进行临床评估时，从宣武医院获取 2019 年 5 月至 2019 年 6 月期间额外的 152 例进行评估。这些数据依然是有标注的数据，两名经验丰富的临床医生，随机采用 5 分制评估影像质量是否满足诊断要求（医生不被告知来源手工标注还是 AI 输出）。</p>
<p>最后，搜集临床应用集，主要用于验证模型在 7 ~ 11 月真实临床应用场景下的性能。</p>
<p><strong>放射科医生标注</strong></p>
<p>为了减少人为误差，采样分层标注的方法。具体来说：</p>
<p>（1）首先使用 ITK-SNAP 对 18259 例样本进行预标注，分别标记骨、主动脉、颈动脉和颅内动脉区域，它们被分为四类。</p>
<p>（2）由 10 名 2+ 年经验的技术人员矫正预标注图像；</p>
<p>（3）由 2 名 5+ 年经验的放射科医生进行复核。如果两名医生意见不一致，则请 10+ 年经验的医生做最后决策；</p>
<p>每例数据所需的平均处理时间约为 22 分钟。</p>
<p><strong>数据预处理和图像增强</strong></p>
<p>尽管标注非常专业和严谨，但是仍然会存在零散噪声。解决的方法是连通分量检测算法（a connected component detection algorithm），消除了散射噪声，提高了数据的鲁棒性。</p>
<p>数据增强策略：</p>
<ul>
<li>水平翻转</li>
<li>不高于 25° 的旋转</li>
<li>不高于 20 pixel 的水平/垂直平移</li>
<li>选择一个矩形区域，随机擦除像素、随机遮挡</li>
</ul>
<p>经过增强后，数据量由 N 增大到 5N。为了增强鲁棒性，在训练时还加入了高斯噪声。</p>
<p><strong>模型开发</strong></p>
<p><img loading="lazy" src="./20210909/12.png" alt=""  />
</p>
<p>自动分割框架包含三个级联的 ResU-Net，完成去骨、提取血管。ResU-Net2 是专门为 Bone edge optimization 设计的，CGPM 用于消除血管分割错误，有效避免部分或缺失的血管节段。</p>
<p>ResU-Net1 和 ResUNet2 模型负责在相同的高分辨率下使用语义分割对整个骨骼进行分割，并根据动脉的大小学习将血管划分为主动脉、颈动脉和颅内动脉的生理解剖结构特征。</p>
<p>根据生理解剖结构，采用 ResU-Net3 模型实现血管分割。</p>
<p>最后，提出的 CGPM 被应用于固定任何破裂的血管，并确保它们可以在形态学水平上被可行地预测和识别。</p>
<p>CGPM 基于 3D-CNN，输入数据包括：</p>
<ul>
<li>original CTA image without labeling</li>
<li>由 ResU-Net1,2,3 生成的分割结果</li>
<li>标注的 CTA 图像</li>
</ul>
<p>CGPM 能准确定位部分缺失的位置，完成对缺失血管的补充。</p>
<p>消融学习，证明管道中每个部件的贡献。</p>
<p><img loading="lazy" src="./20210909/13.png" alt=""  />
</p>
<p><strong>模型性能评估指标</strong></p>
<p>（1）DSC</p>
<p><img loading="lazy" src="./20210909/14.png" alt=""  />
</p>
<ul>
<li>
<p>Y: ground truth</p>
</li>
<li>
<p>$\hat{Y}$: binary predictions from the neural networks</p>
</li>
<li>
<p>$|Y| + |\hat{Y}|$: indicates the sum of each pixel value after calculating the dot product between the ground truth and the prediction.</p>
</li>
</ul>
<p>（2）V-score</p>
<p><img loading="lazy" src="./20210909/15.png" alt=""  />
、</p>
<ul>
<li>V-score 是根据血管的解剖和形态位置来计算的，用于揭示<strong>血管分割的连续性和完整性</strong>。</li>
<li>V-score 越高，血管位置越关键</li>
</ul>
<p>（3）Recall</p>
<p>被正确预测为阳性的病例所占的比例。</p>
<p><img loading="lazy" src="./20210909/16.png" alt=""  />
</p>
<p><strong>临床评估</strong></p>
<p>3 =血管描绘良好，无间断，血管侧支重建良好，血管图像清晰；</p>
<p>2 =正常血管轮廓，部分中断，狭窄程度与无遗漏的源图像相比有偏差；</p>
<p>1 =整个血管中断，与源图像相比有严重的狭窄遗漏。</p>
<p>2019年7月至11月，在宣武医院对 CerebralDoc 的临床应用价值进行了评估，主要从以下几个方面进行：</p>
<ol>
<li>所有接受头颈部CTA检查的患者的覆盖率；</li>
<li>整体、每月、每天的后处理数量，以及成功推送到 PACS 的数量；</li>
<li>后处理所需的平均时间和</li>
<li>后处理的平均时间和 CerebralDoc 和技术员的点击次数（针对100个随机选择的病人）；</li>
<li>测试月份的临床生产力；</li>
<li>模型的错误率（探讨了原因）。</li>
</ol>
<p>===</p>
<p>一些缩写</p>
<p>volume rendering (VR)</p>
<p>maximum intensity projection (MIP)</p>
<p>curve planar reconstruction (CPR)</p>
<p>curved multiple planar reformation (MPR)</p>
<p>connected growth prediction model (CGPM)</p>
<p>computed tomography angiography (CTA)</p>
<p>bottleneck-ResNet (BR)</p>
<p>time-of-flight(TOF)-MRA</p>
<p>absolute volume difference (AVD)</p>
<p>===</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://landodo.github.io/tags/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">论文阅读</a></li>
      <li><a href="http://landodo.github.io/tags/%E5%8C%BB%E5%AD%A6%E5%9B%BE%E5%83%8F%E5%88%86%E5%89%B2/">医学图像分割</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://landodo.github.io/posts/20210924-3d-roi-aware-u-net/">
    <span class="title">« Prev Page</span>
    <br>
    <span>3D RoI-aware U-Net for Accurate and Efficient Colorectal Tumor Segmentation</span>
  </a>
  <a class="next" href="http://landodo.github.io/posts/20210831-structure-boundary-preserving-segmentation/">
    <span class="title">Next Page »</span>
    <br>
    <span>Structure Boundary Preserving Segmentation for Medical Image with Ambiguous Boundary</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>Landon</span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
